
## 开篇

计算机内部会把所有的信息都当成数字来处理，尽管有些信息本来不是数字。用于表示字符的数字是“字符编码”，用于表示颜色的数字是“颜色编码”。

现在的计算机看起来好像是种高度复杂的机器，可是其基本的构造却简单得令人惊讶。从大约50年前的第一代计算机到现在，计算机并没有发生什么改变。在认识计算机时，需要把握的最基础的要点只有三个，我们就将这三个要点称为“计算机的三大原则”吧。无论是多么高深、多么难懂的最新技术，都可以对照着这三大原则来解释说明。

1. 计算机是执行输入、运算、输出的机器
2. 程序是指令和数据的集合
3. 计算机的处理方式有时与人们的思维习惯不同

## 第一章

首先从硬件的基础开始介绍。从硬件上来看，可以说计算机是执行输入、运算、输出三种操作的机器。计算机的硬件由大量的IC （Integrated Circuit，集成电路）组成（如图1.1所示）。每块IC上都带有许多引脚。这些引脚有的用于输入，有的用于输出。

计算机内部主要由被称作IC的元件组成。虽然在IC家族当中有功能各异的各种IC，但是在这里希望诸位记住的只有三种：CPU（Central Processing Unit（中央处理器）、内存以及I/O。

CPU是计算机的大脑，在其内部可对数据执行运算并控制内存和I/O。内存用于存储指令和数据。I/O负责把键盘、鼠标、显示器等周边设备和主机连接在一起，实现数据的输入与输出。

只要用电路把CPU、内存以及I/O上的引脚相互连接起来，为每块IC提供电源，再为CPU提供时钟信号，硬件上的计算机就组装起来了，还是非常简单的吧。所谓时钟信号，就是由内含晶振[插图]的、被称作时钟发生器的元件发出的滴答滴答的电信号。如果是Pentium CPU的话，所使用的时钟信号会从几百MHz到2GHz不等。

通常用Hz来表示驱动CPU运转的时钟信号的频率。1秒发出1次时钟信号就是1Hz，所以100MHz（兆赫兹）的话就是100×100万 = 1亿次/秒。M（兆）代表100万。

### 1.3

编程方法也在进化，进化的成果是诞生了两种编程方法，面向组件编程（Component Based Programming）和面向对象编程（Object Oriented Programming）。Oriented 是关注的意思

这两者的进化目标一致，都是使程序员可以在编程中继续沿用人类创造事物时的方法。面向组件编程的方法是通过将组件（程序的零件）组装到一起完成程序；面向对象编程的方法是先如实地对现实世界的业务建模，之后再把模型搬到程序中。使用符合人类思维习惯的编程方法，可以实现高效率的开发。


## 第二章

制作微型计算机所需的基础元件只有3个，CPU、内存和I/O，每种元件都是作为一块独立的IC在市场上出售的。CPU是计算机的大脑，负责解释、执行程序。内存负责存储程序和数据。I/O是Input/Output（输入/输出）的缩写，负责将计算机和外部设备（周边设备）连接在一起。

PIO（Parallel I/O，并行输入/输出）可以在微型计算机和外部设备之间并行地（一排一排地）输入输出8比特的数据

为了驱动CPU运转，称为“时钟信号”的电信号必不可少。这种电信号就好像带有一个时钟，滴答滴答地每隔一定时间就变换一次电压的高低（如图2.2所示）。输出时钟信号的元件叫作“时钟发生器”。时钟发生器中带有晶振，根据其自身的频率（振动的次数）产生时钟信号。时钟信号的频率可以衡量CPU的运转速度。这里使用的是2.5MHz（兆赫兹）的时钟发生器。

电阻的单位是Ω（欧姆）。电容是存储电荷的元件，衡量存储电荷能力的单位是F（法拉）。要让微型计算机运转起来，5V（伏特）的直流电源是必不可少的。于是还需要使用一个叫作“开关式稳压电源”的装置，将220V的交流电变成5V的直流电。

IC的引脚（所谓引脚就是IC边缘露出的像蜈蚣腿一样的部分）按照逆时针方向依次带有一个从1开始递增的序号。数引脚序号时，要先把表示正方向的标志，比如半圆形的缺口，朝向左侧

寄存器是位于CPU和I/O中的数据存储器。

总线是连接到CPU中数据引脚、地址引脚、控制引脚上的电路的统称。

其实计算机的工作原理非常简单。CPU在时钟信号的控制下解释、执行内存中存储的程序，按照程序中的指令从内存或I/O中把数据输入到CPU中，在CPU内部进行运算，再把运算结果输出到内存或I/O中

而在单片机广泛应用的今天，CPU、I/O、内存都被集成到了一块IC上

## 第三章

本章的目标是通过编写程序使诸位亲身体验计算机的运行机制。为了达到这个目的，就需要使用一种叫作“汇编语言”的编程语言来编写程序，然后再把编好的程序通过手工作业转换成CPU可以直接执行的机器语言。

因为程序的作用是驱动硬件工作，所以在编写程序之前必须要先了解微型计算机的硬件信息

- 机器语言：由二进制数字构成的程序，CPU可以直接对其解释、执行。
- 通常把标识内存或I/O中存储单元的数字称作什么？
    - 通常把标识内存或I/O中存储单元的数字叫作“地址”。
    - 内存中有多个数据存储单元。计算机用从0开始的编号标识每个存储单元，这些编号就是地址（Address）。I/O中的寄存器也可以用地址来标识。哪个寄存器对应哪个地址，取决于CPU和I/O之间的布线方式。
- CPU中的标志寄存器（Flags Register）有什么作用？
    - 用于在运算指令执行后，存储运算结果的某些状态。
    - Flag的本意是“旗子”，这里引申为“标志”。一旦执行了算术运算、逻辑运算、比较运算等指令后，标志寄存器并不会存放运算结果的值，而是会把运算后的某些状态存储起来，例如运算结果是否为0、是否产生了负数、是否有溢出（Overflow）等

- 可以使用哪种机器语言取决于CPU（也称作处理器）的种类。所谓机器语言就是只用0和1两个二进制数书写的编程语言。即便是相同的机器语言，例如01010011，只要CPU的种类不同，对它的解释也就不同。
- 在内存中，每个地址的功能都一样，既可用于存储指令又可用于存储数据。而I/O则不同，地址编号不同（即寄存器的类型不同），功能也就不同。

在机器语言程序中，虽然到处都是0和1的组合，但是每个组合都是有特定含义的指令或数据

可是对人来说，如果只看0和1的话，恐怕很难判断各个组合都表示什么。于是就有人发明出了一种编程方法，根据表示指令功能的英语单词起一个相似的昵称，并将这个昵称赋予给0和1的组合。这种类似英语单词的昵称叫作“助记符”，使用助记符的编程语言叫作“汇编语言”。无论是使用机器语言还是汇编语言，所实现的功能都是一样的，区别只在于程序是用数字表示，还是用助记符表示。也就是说，如果理解了汇编语言，也就理解了机器语言，更进一步也就理解了计算机的原始的工作方式。


既然数据的运算是在CPU中进行的，那么在CPU内部就应该有存储数据的地方。这种存储数据的地方叫作“寄存器”。虽然也叫寄存器，但是与I/O的寄存器不同，CPU的寄存器不仅能存储数据，还具备对数据进行运算的能力。

举例来说，A寄存器也叫作“累加器”，是运算的核心。所以连接到它上面的导线也一定会比其他寄存器的多。F寄存器也叫作“标志寄存器”，用于存储运算结果的状态，比如是否发生了进位，数字大小的比较结果等。PC寄存器也叫作“程序指针”，存储着指向CPU接下来要执行的指令的地址。PC寄存器的值会随着滴答滴答的时钟信号自动更新，可以说程序就是依靠不断变化的PC寄存器的值运行起来的。SP寄存器也叫作“栈顶指针”，用于在内存中创建出一块称为“栈”的临时数据存储区域。


用汇编语言编写的程序是不能直接运行的，必须先转换成机器语言。机器语言是唯一一种CPU能直接理解的编程语言。

。1条汇编语言的指令所对应的机器语言由多个字节构成。而且，同样是汇编语言中的1条指令，有的指令对应着1个字节的机器语言，有的指令则对应着多个字节的机器语言。转换而成的机器语言有多少个字节取决于汇编语言指令的种类以及操作数的个数。代码清单3.3中第一个内存地址是00000000（0号地址），下一个地址是00000010（2号地址），中间隔了2个地址，这说明如果从0号地址开始存储一条2字节的机器语言，那么下一条机器语言就从2号地址开始存储。

还有一点希望诸位注意，在将一个2字节的数据存储到内存时，存储顺序是低8位在前、高8位在后（也就是逆序存储）。这样的存储顺序叫作“小端序”（Little Endian），与此相反，将数据由高位到低位顺序地存储到内存的存储顺序则叫作“大端序”（Big Endian）。根据CPU种类的不同，有的CPU使用大端序，有的CPU使用小端序。


找出执行每条汇编语言指令所需的时钟周期数。然后把代码清单3.2中所用到的每条指令的时钟周期数累加起来。于是可以算出到LOOP标签为止的8条指令共需要7+11+7+11+7+11+7+11 = 72个时钟周期；LOOP标签之后的3条指令共需要11+11+10 = 32个时钟周期。因为微型计算机采用的是2.5MHz的晶振，也就是1秒可以产生250万个时钟周期，所以每个时钟周期是1秒÷250万 = 0.0000004秒= 0.4微秒。72个时钟周期就是72×0.4 = 28.8微秒；32个时钟周期就是12.8微秒。这段程序是用LED的亮或灭来表示指拨开关的开关状态，所以LOOP标签之后所执行的操作“输入、输出、跳转”每1秒可以反复执行1秒÷12.8微秒/次 = 78125次之多，可见计算机的计算速度有多么惊人。


## 第四章
- Flow Chart的中文意思是什么？
    - 流程图

- 请说出自然界中河流的三种流动方式。
    - 向着一个方向流淌；流着流着产生支流；卷成漩涡。
    - 与河流的流动方式一样，程序的流程也分为三种。在程序中，把犹如水流向着一个方向流淌的流程称作“顺序执行”；把犹如水流流着流着产生了支流的流程称作“条件分支”；把犹如水流卷成漩涡的流程称作“循环”。

- 什么事件驱动：用户的操作等产生事件后，由事件决定程序的流程。
    - Windows应用程序的运行就是由事件驱动的。例如，选择“打开文件”菜单项就能打开一个窗口，在里面可以指定要打开文件的名称和存储位置。之所以能够这样是因为一旦触发了“选中了菜单项”这个事件，程序的流程就相应地流转到了处理打开窗口的那部分

CPU中有各种各样的各司其职的寄存器。其中有一个被称为PC （Program Counter，程序计数器）的寄存器，负责存储内存地址，该地址指向下一条即将执行的指令。每解释执行完一条指令，PC寄存器的值就会自动被更新为下一条指令的地址。

所谓算法（Algorithm），就是解决既定问题的步骤。想让计算机解决问题，就需要把问题的解法转换成程序的流程。

思考算法时的要点是要分两步走，先从整体上考虑程序的粗略流程，再考虑程序各个部分细节的流程

但是几乎所有的程序从整体来看都具有一个一成不变的流程，那就是“初始化处理”→“循环处理”→“收尾处理”。大事化小，小事化了

最后，稍微介绍一下两种特殊的程序流程——中断处理和事件驱动（Event Driven）。首先说明中断处理。

中断处理以从硬件发出的请求为条件，使程序的流程产生分支，因此可以说它是一种特殊的条件分支。可是，在诸位编写的程序中并不需要编写有关中断处理的代码。因为处理中断请求的程序，或是内置于被烧录在计算机ROM中的BIOS系统（Basic Input Output System，基本输入输出系统）中，或是内置于Windows等操作系统中。诸位只需要先记住以下两点即可：计算机具有硬件上处理中断的能力；中断一词的英文是Interrupt。


RAM（Random Access Memory 随机访问存储器）和ROM（Read Only Memory 只读存储器）都是计算机存储器，但它们的功能和特性有很大的不同。

RAM是一种易失性存储器，它可以被写入和读取，而且数据可以被多次修改。RAM中存储的数据可以被随机访问和操作，因此被称为随机访问存储器。

ROM是一种非易失性存储器，它仅能被写入一次，读取无数次，且存储的数据不能被修改。ROM通常用于存储固件，如计算机的BIOS（基本输入/输出系统）和操作系统的启动代码等。

RAM和ROM的区别还包括存储速度、价格、容量和使用方式等方面。RAM的读写速度比ROM快，但价格更贵，存储容量也更小。RAM常用于计算机内存和高速缓存等场景，而ROM通常用于存储固件和只读数据等场景。

在计算机系统中，RAM和ROM通常被组合使用，以实现系统的各种功能和操作。


程序员们经常用事件驱动的方式编写那些工作在GUI（Graphical User Inteface，图形用户界面）环境中的应用程序

通常把用户在应用程序中点击鼠标或者敲击键盘这样的操作称作“事件”（Event）。负责检测事件的是Windows。Windows通过调用应用程序的WndProc()函数通知应用程序事件的发生。而应用程序则根据事件的类型做出相应的处理。这种机制就是事件驱动。

事件驱动是一种适用于GUI环境的编程风格，在这种环境中用户可以通过鼠标和键盘来操作应用程序。

## 第五章

最大公约数指的是两个整数的公共约数中最大的数。使用辗转相除法，就可以通过机械的步骤求出最大公约数。

“哨兵”指的是一种含有特殊值的数据，可用于标识数据的结尾等。字符串的末尾用0表示，链表的末尾用-1表示，像这种特殊的数据就是哨兵。

算法：被明确定义的有限个规则的集合，用于根据有限的步骤解决问题。

在算法技巧中有个著名的技巧叫作“哨兵”。这个技巧多用在线性搜索（从若干个数据中查找目标数据）等算法中。线性搜索的基本过程是将若干个数据从头到尾，依次逐个比对，直到找到目标数据。

下面还是通过例题来思考吧。假设有100个箱子，里面分别装有一个写有任意数字的纸条，箱子上面标有1～100的序号。现在要从这100个箱子当中查找是否有箱子装有写着要查找数字的纸条。

首先看看不使用哨兵的方法。从第一个箱子开始依次检查每个箱子中的纸条。每检查完一个纸条，还要再检查箱子的编号（用变量N表示），并进一步确认编号是否已超过最后一个编号了

虽然看起来似乎没什么问题，但是实际上含有不必要的处理——每回都要检查箱子的编号有没有到100。为了消除这种不必要的处理，于是添加了一个101号箱子，其中预先放入的纸条上写有正要查找的数字。这种数据就被称为“哨兵”。通过放入哨兵，就一定能找到要找的数据了。找到要找的数据后，如果该箱子的编号还没有到101就意味着找到了实际的数据；如果该箱子的编号是101，则意味着找到的是哨兵，而没有找到实际的数据。

其实哨兵可以减少执行的次数，提高算法效率。

所有的信息都可以用数字表示——这是计算机的特性之一。因此为了构造算法，经常会利用到存在于数字间的规律，比如石头剪刀布游戏，如果不从数字中总结规律，那无非就是全排列，然后统计谁输谁赢。
但是如果总结了数字规律，那就不同了。。。如果把石头、剪刀、布分别用数字0、1、2表示，把玩家A做出的手势用变量A表示，玩家B做出的手势用变量B表示，那么变量A和B中所存储的值就是这三个数中的某一个：
- 如果变量A和B相等就是“平局”
- 如果用B+1除以3得到的余数与变量A相等就是“玩家B获胜”
- 其余的情况都是“玩家A获胜”

构造算法时需要找出数字间的规律不仅适用于数学游戏，

最后介绍最为重要的一点，那就是思考算法的时候，要先在**纸上用文字或图表描述出解决问题的步骤，而不要立刻开始编写代码**。

## 第六章
程序中的变量是指什么？变量是数据的容器，变量中所存储的数据是可以改变的。变量的实质是按照变量所存储数据的大小被分配到的一块内存空间。

使用了数组就可以高效地处理大量的数据。数组的实质是连续分配的一块特定大小的内存空间。

程序员有必要把算法（处理问题的步骤）和数据结构（作为处理对象的数据的排列方式）两者放到一起考虑。选用的算法和数据结构两者要相互匹配这一点很重要

计算机所处理的数据都存储在了被称为内存的IC（Integrated Circuit，集成电路）中。在一般的个人计算机中，内存内部被分割成了若干个数据存储单元，每个单元可以存储8比特的数据（8比特 = 1字节）。为了区分各个单元，每个单元都被分配了一个编号，这个编号被称为“地址”或是“门牌号码”。如果一台个人计算机装配有64M字节的内存，那么就会有从0到64M（M = 100万）这么多个地址。

因为依靠指定地址的方式编写程序很麻烦，所以在C语言、Java、BASIC等几乎所有的编程语言中，都是使用变量把数据存储进内存，或从内存中把数据读出来的。

对于程序员来说，他们并不需要知道变量a被存储到内存空间中的哪个地址上了。因为当程序运行时是由操作系统为我们从尚未使用的内存空间中划分出一部分分配给变量a的。如图6.1所示，变量是程序中数据存储的最小单位，每个变量都对应着一块物理上的内存空间。

数组是数据结构的基础，之所以这么说是因为数组反映了内存的物理结构本身。在内存中存储数据的空间是连续分布的。而在程序中，往往要从内存整体中分配出一块连续的空间以供使用。


这里的成员Ptr存储了数组中另一个元素的地址。在C语言中，把存储着地址的变量称为“指针”。这里的“*”（星号）就是指针的标志
```c++
struct TestResult{
    char Chinese;              /＊ 语文成绩 ＊/
    char Math;                 /＊ 数学成绩 ＊/
    char English;              /＊ 英语成绩 ＊/
    struct TestResult＊ Ptr;  /＊ 指向其他元素的指针 ＊/
};
```

在二叉树的实现中，用的还是自我引用的结构体，只不过要改为要带有两个连接信息的成员的自我引用结构体
```c
struct TestResult{
    char Chinese;              /＊ 语文成绩 ＊/
    char Math;                 /＊ 数学成绩 ＊/
    char English;              /＊ 英语成绩 ＊/
    struct TestResult＊ Ptr1; /＊ 指向其他元素的指针1 ＊/
    struct TestResult＊ Ptr2; /＊ 指向其他元素的指针2 ＊/
};
```

二叉树多用于实现那些用于搜索数据的算法，比如“二分查找法”。比起只使用链表，使用二叉树能够更快地找到数据。因为搜索数据时并不是像在简单数组中那样沿一条线搜索，而是寻着二叉树不断生长出来的两根树杈中的某一枝搜索，这样就能更快地找到目标数据了

无论是在哪种编程语言中，数据结构的基础都是数组，因此设法灵活地运用数组才是关键。

## 第七章 成为会使用面向对象编程的程序员吧

++是表示自增（每次只将变量的值增加1）的C语言运算符。之所以被命名为C++，是因为C++在C语言的基础上增加了面向对象的机制这一点。另外，将C++进一步改良的编程语言就是Java和C#语言。

面向对象编程是一种基于以下思路的程序设计方法：将关注点置于对象（Object）本身，对象的构成要素包含对象的行为及操作[插图]，以此为基础进行编程。这种方法使程序易于复用，软件的生产效率因而得以提升。其中所使用的主要编程技巧有继承、封装、多态三种。

在面向对象编程中，使用了一种称为“类”的要素，通过把若干个类组装到一起构建一个完整的程序。从这一点来看，可以说类就是程序的组件（Component）。面向对象编程的关键在于能否灵活地运用类。

在使用古老的C语言或BASIC等语言编程时（它们不是面向对象的编程语言，即不是用于表达面向对象编程思想的语言），用“函数”表示指令，用“变量”表示数据。对于C语言或是BASIC的程序员而言，程序就是函数和数据的集合。在代码清单7.1中，用FunctionX的形式为函数命名，用VariableX的形式为变量命名。

在大型程序中需要用到大量的函数和变量。假设要用非面向对象的编程方法编写一个由10000个函数和20000个变量构成的程序，那么结果就很容易是代码凌乱不堪，开发效率低到令人吃惊，维护起来也十分困难。

于是一种新的编程方法就被发明出来了，即把程序中有关联的函数和变量汇集到一起编成组。这里的组就是类。在C++、Java、C#等面向对象编程语言中，语法上是支持类的定义的。

在使用面向对象编程语言开发时，并不是所有的类都必须由程序员亲自编写。大部分的类都已内置于面向对象编程语言中了，这些类可以为来自各个领域的程序员所使用。通常将像这样的一组类（一组组件）称作“类库”。通过利用类库可以提升编程的效率。还有一些类原本是为开发其他程序而编写的，如果可以把这些现成的类拿过来使用，那么程序的开发效率就更高了。

可以说建模就是在为面向对象编程做设计。为了把对现实世界建模的结果以图形的形式表示出来，还经常使用被称作UML（Unified Modeling Language，统一建模语言）的表记方法。UML是通过统一历史上曾经出现的各种各样的表记方法而发明出来的，事实上UML已经成为了建模表记方法中的世界标准

在UML中，规定了九种图（见表7.1）。之所以有这么多种，是为了从各种各样的角度表示对现实世界建模的结果。例如用例图是从用户的角度，即用户使用程序的方式出发表示建模结果的一种图。而类图等出发的角度则是程序。

- 用例图，表示用户使用程序的方式
- 类图，表示类以及多个类之间的关系
- 对象图，表示对象
- 时序图，从时间上关注并表示多个对象间的交互
- 协作图，从合作关系上关注并表示多个对象见的交互
- 状态图，表示对象状态的变化
- 活动图，表示处理的流程等
- 组件图，表示文件以及多个文件之间的关系
- 配置图，表示计算机或程序的部署配置方法

UML仅仅规定了建模的表记方法，并不专门用于面向对象编程。

- 继承指的是通过继承已存在的类所拥有的成员而生成新的类。
- 封装指的是在类所拥有的成员中，隐藏掉那些没有必要展现给该类调用者的成员。为了对类进行封装，需要在类成员的定义前指定关键词public（表示该成员对外可见）或是private（表示该成员对外不可见）
- 多态指的是针对同一种消息，不同的对象可以进行不同的操作

首先，要说明一下类和对象的区别。在面向对象编程中，类和对象被看作是不同的概念而予以区别对待。**类是对象的定义，而对象是类的实例（Instance）。**

类是做饼干的模具，用模具做出来的饼干是对象

Java和．NET其实是位于操作系统（Windows或Linux等）之上，旨在通过隐藏操作系统的复杂性从而提升开发效率的程序集，这样的程序集也被称作“框架”（Framework）。框架由两部分构成，**一部分是负责安全执行程序的“执行引擎”，另一部分是作为程序组件集合的“类库”**

## 第八章 数据库

- 表（Table）就是被整理成表格形式的数据，一张表由若干个列和行构成。列也被称为字段（Field），行也被称为记录（Record）。
- DBMS是Database Management System（数据库管理系统）的简称。市面上的DBMS有SQL Server、Oracle、DB2等。无论是哪种DBMS都可以用基本相同的SQL语句操作
- 键用于设定表和表之间的关系（Relationship），而索引是提升数据检索速度的机制。其上每个值都能够唯一标识一条记录的字段称为主键。为了在表和表之间建立关系而在表中添加的、其他表主键的字段称为外键。而索引是与键无关的机制。

所谓数据库（Database）就是数据（Data）的基地（Base）。在实施企业的商业战略时，如果企业内的数据散布在各个地方，在更新和检索时就要花费大量时间，分析起来就会很麻烦。但是只要把企业内的数据预先汇集到一个“基地”中并加以整理，各个部门中充满干劲的员工就可以根据需要灵活地使用这些数据。这个数据的基地就是数据库

适合存储大规模数据的是关系型数据库（Relational Database）。在关系型数据库中，数据被拆分整理到多张表中，同时表与表之间的关系也可以被记录下来

诸位可以从零开始埋头编写所有代码，但是一般情况下，还是会借助称作DBMS的软件。Microsoft Access、Oracle、SQL Server、DB2等诸位都有所耳闻吧，这些都是DBMS的实例。数据库的实质虽然是某种数据文件，但是诸位编写的应用程序并不是直接去读写这些数据文件，而是以DBMS作为中介间接地读写（如图8.3所示）。DBMS不但可以使应用程序轻松地读写数据文件，而且还具有一致并且安全地存储数据的功能。

数据库系统的构成要素包括
- “数据文件”
- “DBMS”
“应用程序”三部分。

- 在小型系统中，把三个要素全部部署在一台计算机上，称作“独立型系统”。
- 在中型系统中，把数据文件部署在一台计算机上，并且使数据文件被部署了DBMS和应用程序的多台计算机共享，这样的系统被称为“文件共享型系统”。
- 在大型系统中，把数据文件和DBMS部署在一台（或者多台）计算机上，然后用户从另外一些部署着应用程序的计算机上访问，这样的系统被称作“客户端/服务器型系统”。

其中部署着数据文件和DBMS的计算机是服务器（Server），即服务的提供者；部署着应用程序的计算机是客户端（Client），即服务的使用者

1. 首先从设计数据库开始。而设计数据库的第一步是从“你想要了解什么”的视角出发找出需要的数据
2. 把必要的数据筛选出来以后，下一步要考虑的是各种数据的属性。属性也称作模式（内模式），具体来说就是数据的类型（是数字还是字符串），数字的话是整数还是浮点小数，字符串的话最多允许包含多少个字符，是否允许NULL值（表示未知或者不存在的值），等等。
3. 

为了在表间建立关系，就必须加入能够反映表与表之间关系的字段，为此所添加的新字段就被称为键（Key）首先要在各个表中添加一个名为主键（Primary Key）的字段，该字段的值能够唯一地标识表中的一条记录

在销售记录表上，还要添加顾客ID和商品ID字段，这两个字段分别是另外两张表的主键，对于销售记录表来说，它们就都是“外键”（Foreign Key）。通过主键和外键上相同的值，多个表之间就产生了关联，就可以顺藤摸瓜取出数据。

主键既可以只由一个字段充当，也可以将多个字段组合在一起形成复合主键，表之间的关系使记录和记录关联了起来。记录之间虽然在逻辑上有一对一、多对多以及一对多（等同于多对一）三种关系，但是在关系型数据库中无法直接表示多对多关系。这是因为在多个字段中以顺藤摸瓜的方式查找数据并不是那么容易的。如果将酒铺的数据库只分为顾客表和商品表，那么这两张表就形成了多对多关系。也就是说一位顾客可以购买多个商品，反过来一种商品可以被多位顾客所购买。当出现多对多关系时，可以在这两张表之间再加入一张表，把多对多关系分解成两个一对多关系（如图8.10所示）。加入的这张表被称作连接表（Link Table）。在酒铺数据库中，销售记录表就是连接表。如图8.7所示，在表示一对多关系的连线的两端，写有“1”的一侧表示“一”，写有“∞”、即无穷大符号的一侧表示“多”。


可以在表的各个字段上设置索引（Index），这也是DBMS所具备的功能之一。虽然索引和键这两个概念容易让人混淆，但其实两者是完全不同的。索引仅仅是提升数据检索和排序速度的内部机制。一旦在字段上设置了索引，DBMS就会自动为这个字段创建索引表（如图8.12所示）

索引表是一种数据结构，存储着字段的值以及字段所对应记录的位置。例如，如果在顾客表的顾客姓名字段上设置了索引，DBMS就会创建一张索引表（如图8.13所示），表中有两个字段，分别存储着顾客姓名和位置（所对应的记录在数据文件中的位置）。与原来的顾客表相比，索引表中的字段数更少，所以可以更快地进行数据的检索和排序。当查询数据时，DBMS先在索引表中进行数据的检索和排序，然后再根据位置信息从原来的数据表中把完整的记录取出来。索引所起的就是“目录”的作用。与图书的目录一样，数据库的索引也是一种能够高效地查找目标数据的机制。

也许会有人这样想，既然索引能够提升检索和排序的速度，那么在所有表的所有字段上都加上索引不就好了吗？实际上并不能这样做。因为一旦设置了索引，每次向表中插入数据时，DBMS都必须更新索引表。提升数据检索和排序速度的代价，就是插入或更新数据速度的降低。因此，只有对那些要频繁地进行检索和排序的字段，才需要设置索引。在酒铺数据库这个例子中，只需要在顾客表的顾客姓名字段和商品表的商品名称字段上设置索引就足够了。如果表中充其量也就只有几千条记录，那么即使完全不使用索引，也不会感到检索或排序速度有多慢。

设计系统时，请诸位记住一个重要的顺序：优先设计数据库，然后再设计用户界面。

为了对数据库进行CRUD操作，就必须从应用程序向DBMS发送命令。这里所使用的命令就是SQL语言（Structural Query Language，结构化查询语言）。SQL语言的标准是由ISO（International Organization for Standardization，国际标准化组织）制订的。现在市面上几乎所有的DBMS都支持SQL语言。

一旦向DBMS发送了一条命令（SQL语句），与此相应的操作就会立刻被执行。与BASIC或C语言等编程语言不同的是，使用SQL语言通常不需要定义变量或者考虑程序的执行流程。

最后介绍DBMS的一个高级功能——事务控制。事务由若干条SQL语句构成，表示对数据库一系列相关操作的集合。有一个经典的银行账户间汇款的例子可以用于说明其概念。为了从顾客A的账户中给顾客B的账户汇入1万日元，就需要将以下两条SQL语句依次发送给DBMS:1．把A的账户余额更新（UPDATE语句）为现有余额减去1万日元；2．把B的账户余额更新（UPDATE语句）为现有余额加上1万日元。此时这两条SQL语句就构成了一个事务。

假设在第一条SQL语句执行后，网络或计算机发生了故障，第二条SQL语句无法执行，那么会发生什么呢？A的账户余额虽然减少了1万日元，但是B的账户余额却没有相应地增加1万日元，这就导致了数据不一致。为了防止出现这种问题，在SQL语言中设计了以下三条语句：1. BEGIN TRANSACTION（开启事务）语句，用于通知DBMS开启事务；2. COMMIT（提交事务）语句，用于通知DBMS提交事务；3. ROLL BACK（事务回滚）语句，用于在事务进行中发生问题时，把数据库中的数据恢复到事务开始前的状态（如图8.16所示）

## 第九章 通过七个简单的实验理解TCP/IP 网络

LAN是Local Area Network（局域网）的缩略语。
TCP/IP 是 Transmission Control Protocol/Internet Protocol（传输控制协议和网际协议）的缩略语。TCP/IP协议族是互联网所使用的一套标准协议。TCP/IP这个名字意味着同时使用了TCP协议和IP协议
所谓MAC地址就是能够标识网卡的编号。

因为信息可以以电信号的形式在网线中传播，所以计算机彼此之间就能够进行信息交换。但为了交换信息，还必须在发送者和接收者之间事先确定发送方式。这种对信息发送方式的规定或约束就称为“协议”（Protocol）。小到公司内部的网络，大到互联网，TCP/IP（Transmission Control Protocol/Internet Protocol）协议族已然成为了现行的标准。

在服务器上运行的程序为客户端提供服务。“集线器”（Hub）是负责把各台计算机的网线相互连接在一起的集线设备。“路由器”（Router）是负责把公司内的网络和互联网连接起来的设备。

路由器负责将LAN连接到WAN上。路由器的一端会先连接到互联网服务提供商的路由器上。而在服务提供商（Provider）那里，又会继续将它们的路由器连接到其他路由器上，通过这种方式最终接入到互联网的主干线缆上

路由器和猫（Modem）是两种不同的网络设备，虽然它们有些功能上的重叠，但是其主要用途和工作方式有所不同。

猫是一个缩写，全称是调制解调器（Modem），其主要作用是将数字信号转换成模拟信号，以便于在电话线路上传输。猫通常会通过电话线或者有线电视等物理介质连接到网络服务提供商（ISP）的网络中，将ISP提供的信号转换为计算机可以识别的数字信号，从而使计算机能够访问互联网。猫通常只有一个局域网口，只能给一个设备提供网络连接。

而路由器则是一种网络设备，它可以用于将一个局域网中的多个设备连接到互联网上，或者将多个局域网连接起来。路由器通常包括有多个局域网口和一个广域网口，可以将来自不同局域网的数据包转发到正确的目标设备上。路由器还可以提供网络地址转换（NAT）、端口转发等功能，以便于多个设备可以共享一个公网IP地址。此外，路由器还可以提供一些网络管理和安全功能，如DHCP服务、VPN等。

综上，猫主要用于将ISP提供的信号转换为计算机可以识别的数字信号，而路由器则用于将多个设备连接到互联网上或者将多个局域网连接起来，并提供一些网络管理和安全功能。两者的主要区别在于其用途和功能。

计算机是硬件和软件的集合体，网络也不例外。那么首先，我们就从构成网络的硬件开始探索吧。在组建公司内部的网络时，笔者购买了如下4种硬件：1．安装到每台计算机上的网卡（NIC, Network Interface Card）;2．插到网卡上的网线；3．把网线汇集起来连接到一处的集线器；4．用于接入到互联网的路由器。


网卡（Network Interface Card，简称NIC）是计算机与网络之间的桥梁，用于将计算机与其他设备连接到网络中。它主要负责网络协议的处理、数据的发送和接收等功能，是实现计算机与网络之间通信的关键硬件设备之一。网卡的类型包括有线网卡和无线网卡，有线网卡通常使用Ethernet协议进行通信，而无线网卡则使用无线协议，如Wi-Fi。

通常把设定了IP地址的计算机称为“主机”（Host）。因为路由器也算是计算机的一种，所以它们也有IP地址。

通过IP地址就可以轻松地对计算机进行分组管理了。比如用IP地址中第1段到第3段的数值代表公司，用第4段的数值代表公司内部的计算机。例如，在AAA.BBB.CCC这个公司内，如果有一台计算机的编号是×××，那么它的IP地址就是AAA.BBB.CCC.XXX。而看到了AAA.BBB.CCC.YYY这样一个IP地址，就能知道它是这个公司内的另一台计算机。通常把IP地址中表示分组（即LAN）的部分称作“网络地址”、表示各台计算机（即主机）的部分称为“主机地址”。在本例中，AAA.BBB.CCC这一部分是网络地址，而XXX或YYY的部分是主机地址。


子网掩码的作用是标识出在32比特的IP地址中，从哪一位到哪一位是网络地址，从哪一位到哪一位是主机地址。把255.255.255.240用二进制表示的话，结果如下所示。11111111.11111111.11111111.11110000子网掩码中，值为1的那些位对应着IP地址中的网络地址，后面值为0的那些位则对应着主机地址。因此255.255.255.240这个子网掩码就表示，其所对应的IP地址前28比特是网络地址，后4比特是主机地址。

虽然在这个对话框中可以手动设置IP地址和子网掩码，但是大多数情况下选择的还是“自动获得IP地址”这个选项。这个选项使得计算机在启动时会去从DHCP服务器获取IP地址和子网掩码，并自动地配置它们。DHCP的全称是Dynamic Host Configuration Protocol（动态主机设置协议）。

DHCP服务器上记录着可以被分配到LAN内计算机的IP地址范围和子网掩码的值。作为DHCP客户端的计算机在启动时，就可以从中知道哪些IP地址还没有分配给其他计算机。  打开命令行工具并输入 "ipconfig"（Windows）或 "ifconfig"（macOS/Linux），然后查找输出中的 "Default Gateway" 条目。这个条目就是你的路由器地址。

也就是说路由器就是从LAN通往互联网世界的入口（Gateway）。路由器的IP地址也可以从DHCP服务器获取。最后再请诸位注意一点，这里选择了“自动获得DNS服务器地址”这一选项。也就是说，DNS服务器的IP地址也可以从DHCP服务器获取。

Metric这一列记录着路径的权重，这个值由某种算法决定，比如数据传输过程中经过的路由器的数量。如果遇到有多条候选路径都可以通往目的地的情况，路由器就会选择Metric值较小的那条路径。

traceroute是一个计算机网络工具，用于诊断网络连接问题。它通过发送一系列的探测包（probe packets）到目标主机，以获取到目标主机与本地主机之间经过的路由路径，以及各个路由节点的延迟。traceroute通常用于测试互联网中的路由器性能，诊断互联网连接问题，以及发现网络中的瓶颈和拥塞点。

traceroute命令通常在命令行界面下执行，它的具体用法取决于所用的操作系统和网络环境。在Linux和Unix系统中，traceroute通常使用traceroute命令；在Windows系统中，traceroute通常使用tracert命令。

traceroute的原理是使用Internet Control Message Protocol (ICMP) 协议的“时间到达”（time-to-live，TTL）机制。每个探测包在经过一个路由器时，TTL值会减少1，并将该值附加在数据包的IP头部。当TTL值降至0时，路由器将丢弃该数据包并向源主机发送一个ICMP消息，通知源主机该路由器的存在。通过在探测包上逐渐增加TTL值，traceroute可以得知目标主机与本地主机之间的路由路径。

输入 nslookup 命令后，就可以开启查询dns服务器了，输入对应的域名就会输出对应的ip地址等，当然也可以直接 nslookup www.baidu.com 执行一次性查询


在互联网的世界中，到处传输的都是附带了iP地址的数据。但是能够标识作为数据最终接收者的网卡的，还是MAC地址。于是在计算机中就加入了一种程序，用于实现由IP地址到MAC地址的转换，这种功能被称作ARP（Address Resolution Protocol，地址解析协议）。ARP的工作方式很有意思。它会对LAN中的所有计算机提问：“有谁的IP地址是210.160.205.80吗？有的话请把你的MAC地址告诉我。”通常把这种同时向所有LAN内的计算机发送数据的过程称作“广播”（Broadcast）。通过广播询问，如果有某台计算机回复了MAC地址，那么这台计算机的IP地址和MAC地址的对应关系也就明确了。ARP的工作流程也是自动进行的，诸位并不会意识到。如果为了查询MAC地址，每回都要进行广播询问，那么查询的效率就会降低。于是ARP还提供了缓存的功能，当向各个计算机都询问完一轮之后，就会把得到的MAC地址和IP地址的对应关系缓存起来（临时保存在内存中）。存起来的这些对应关系信息称作“ARP缓存表”。只要在命令提示符窗口中执行arp -a命令，就可以查看当前ARP缓存表中的内容。那么，作为最后的实验，我们就来查看一下ARP缓存表吧。  在命令行里可以输入 arp -a 查看arp缓存表

硬件上发送数据的是网卡。在网卡之上是设备驱动程序（用于控制网卡这类硬件的程序），设备驱动程序之上是实现了IP协议的程序，IP程序之上则是实现了TCP协议的程序，而再往上才是应用程序，比如Web或电子邮件。这样就构成了一幅在硬件之上堆叠了若干个软件层的示意图（如图9.15所示）。TCP协议使用被称作“TCP端口号”的数字识别上层的应用程序。TCP端口号中有一些是预先定义好的，比如Web使用80端口，电子邮件使用25端口（用于发送）和110端口（用于接收）。

## 第十章
## 第十一章
## 第十二章