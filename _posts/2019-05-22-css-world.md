---
layout: post
title: CSS世界笔记
date: Fri May 10 2019 17:25:47 GMT+0800 (中国标准时间)
---

### **参考资料**

[CSS世界][CSSWorldUrl]、

---

### **流的破坏与保护**

在`CSS`中，标准数据流总是挨个平铺整个页面，但有时会了实现一些效果，就必须要破坏这种标准数据流结构，当然有破坏就需要保护，也就是破坏流和保护流的`CSS`属性。

#### **魔鬼属性float**

`1. float的本质与特质`  
早期的`float`属性是用来实现文字环绕效果的，而这种文字环绕，主要指的就是文字环绕图片显⽪的效果。也就是说`CSS2`属性的设计都是为图文展示服务的，`float`也是如此。

而现在用`float`进行布局，会出现很多意外的情况，其实是对其的滥用。但既然用了，就的解决其带来的各种问题，首先来看看`float`属性的特性：

- 包裹性
- 块状化并格式化上下文
- 破坏文档流
- 没有任何`margin`合并

**1. 包裹性**其实包含两部分：**包裹和自适应性**

**包裹：**假设浮动元素父元素宽`200px`，浮动子元素为`128px`宽的图片，此时浮动元素宽度表现为包裹性，也就是图片的宽度`128px`。

```html
<style>
  .father { width: 200px; }
  .float { float: left; }
  .float img { width: 128px; }
</style>

<div class="father">
  <div class="float">
    <img src="test.jpg">
  </div>
</div>
```

**自适应：**假设浮动元素子元素不单单有`128px`宽的图片，还有一段文字。此时浮动元素宽度自适应宽度就是父元素的`200px`，当然要想自适应父元素的宽度，一定是浮动元素的**首选最小宽度**(其实就是是否可换行显示)比父元素的宽度小的前提下。如果文字是一串很长不间断的英文，则英文默认无法断开，因此总体下来就会超过`200px`

```html
<style>
  .father { width: 200px; }
  .float { float: left; }
  .float img { width: 128px; }
</style>

<div class="father">
  <div class="float">
    <img src="test.jpg">此时宽度依据文字首选最小宽度与图片的总和

    <!-- 换成英文,无法折行，超过200px -->
    <img src="test.jpg">ddoeohfoiwewepquwpeurqpweurpwquterpweutiwt
  </div>
</div>
```

**2. 块状化**，`float`属性一旦不为`none`，则`display`就为`block或table`，可以用如下代码测试：

```js
var span = document.createElement('span');
document.body.appendChild(span);
console.log('1. ' + window.getComputedStyle(span).display); // 1. inline

// 设置浮动
span.style.cssFloat = 'left';
console.log('2. ' + window.getComputedStyle(span).display); // 2. block
```

只有一个属性`display:inline-block;`设置为`float`后，`display:table`。既然属性变为了`block`后，则有些设置就没有了意义，如下：

```css
span {
  display: block;         /* 多余 */
  float: left:
}
span {
  vertical-align: middle; /* 多余，块级没有基线问题 */
  float: left:
}
span {
  text-align: right;      /* 谷歌浏览器测试有效 */
  float: left:
}
```

**注意：**虽然设置了`float`后，`display`属性表现为`block或table`，但**并不是说此时样式就自动撑满屏幕**了(块级特性)

`2. float的作用机制`  
`float`有个突出表现，就是会让父元素的高度塌陷，其实这种塌陷才是正常。。。因为float就是为了实现文字环绕效果。比如如何让如下代码实现文字围绕图片？

```html
<div class="father">
  <img src="test.jpg">
</div>
<p class="animal">这是文字，这是文字，...</p>
```

因为`div、p`都是是块级自动撑满整个屏幕。要想实现文字环绕，只需给`img`标签添加`float:left`即可，此时`div`高度塌陷为0。。。这里也可以看出，**`float`属性让父元素高度塌陷的原因就是为了实现文字环绕效果**，但随着发展，`float`常被用来布局。。。而布局的话，高度塌陷就成为了问题

高度塌陷，跟随的内容也就可以和浮动元素在一个水平线上了，但这只是实现“环绕效果”的条件之一，要想实现真正的“环绕效果”，就需要另外一个平时大家不太在意的特性，那就是**行框盒子和浮动元素的不可重叠性**。。。

这里解释下**行框盒子**，其实对于`<p>这是文字</p>`来说，`p`是**块级盒子**，而“这是文字”是具体的内容，而就在这个具体的内容上有个****行框盒子****，如果非要用代码显示出来的话就是：

```html
<style>
.animal:first-line {
  backgroud:pink;
  color: blue;
}
</style>

<div class="father">
  <img src="test.jpg" style="float:left;">
</div>
<p class="animal">这是文字，这是文字，...</p>
```

也就是**每行内联元素都会默认在一个隐藏的盒子里**，而这个盒子就是**行框盒子**，注意：是**每行内联元素**。而且这个隐藏的盒子无法用`CSS`属性改变。


[CSSWorldUrl]: https://book.douban.com/subject/27615777/ '张鑫旭CSS世界'