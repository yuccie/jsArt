---
layout: post
title: 读源码之前，你或许需要这些skills
date: Mon Dec 03 2018 15:28:30 GMT+0800 (中国标准时间)
---

在读vue源码之前，需要了解的那些技能点
#### typeScript

##### 同一份代码在不同环境变量下编译时，可能会因为以下因素表现不同：
1. 第三方模块的版本差异：某些模块在不同的版本下，其 API 可能会发生变化，从而影响代码的兼容性和正确性。
2. 编译器版本差异：不同版本的 TypeScript 编译器会有不同的行为，比如编译速度、错误提示等方面可能会有所差异。
3. 环境变量的不同：某些环境变量的设置，比如 NODE_ENV，可能会导致编译时引入不同的配置文件，从而影响编译结果。
4. 代码的不同分支：如果代码在不同的分支上有不同的实现，那么编译结果也会有所不同。
要解决这些问题，可以采取以下措施：
1. 为每个环境使用相同的依赖版本，或者使用锁定依赖的方式来确保依赖版本的一致性。
2. 统一使用相同版本的 TypeScript 编译器。
3. 确保在不同的环境中使用相同的环境变量，或者使用不同的编译配置文件来处理环境变量的不同。
4. 使用版本控制工具管理代码分支，并确保代码分支之间的差异最小化，以避免编译时产生不必要的差异。
5. 

##### TypeScript类型校验的运行过程可以大致分为以下几步：
1. 将.ts或.tsx文件编译成JavaScript代码。
2. 通过配置文件tsconfig.json指定编译过程中的类型检查规则，例如配置strict为true时表示开启全部类型检查。
3. 在编译过程中，TypeScript解析代码并构建语法树，同时通过类型推断、类型注解等方法获取变量的类型信息。
4. TypeScript利用获取到的类型信息对代码进行类型检查，如果检查失败会发出警告或错误信息。
总的来说，TypeScript的类型校验过程主要依赖于类型推断和类型注解两种方式获取变量的类型信息，并利用这些信息对代码进行类型检查，从而提高代码的健壮性和可维护性。


TypeScript LSP (Language Server Protocol) 是一种协议，它规定了语言服务器和编辑器之间的通信方式。它定义了一些标准化的请求和响应协议，用于在编辑器中提供智能代码编辑、自动补全、类型检查等功能。其运行原理如下：
1. 安装 LSP 插件：先安装编辑器相关的 LSP 插件，如 VS Code 自带的 TypeScript 插件。
2. 连接服务器：当编辑器启动时，会通过 LSP 插件向 TypeScript LSP 服务器发出连接请求，建立编辑器和服务器之间的通信。
3. 启动类型检查：一旦连接建立，编辑器会将当前文件的内容发送到服务器，请求进行语法和类型检查。
4. 接收检查结果：服务器会对代码进行分析，并返回对应的检查结果，如错误和警告等。
5. 解析文件：当编辑器需要访问其他文件时，它会发送一个文件解析请求给服务器，服务器返回文件的 AST（抽象语法树）和其依赖的文件列表。
6. 自动补全：当用户在编辑器中输入代码时，编辑器会向服务器发送自动补全请求，服务器返回代码建议列表。
7. 代码跳转：当用户在编辑器中单击代码时，编辑器会向服务器发送代码跳转请求，服务器返回代码的位置信息。
8. 重构：当用户执行重构操作时，编辑器会向服务器发送重构请求，服务器会根据请求修改代码，并返回修改结果。
这样通过 LSP，编辑器和 TypeScript LSP 服务器之间可以进行高效的通信，提供智能代码编辑、自动补全、类型检查等功能。


以前要么是编辑器本身根据语法规则检查语法，要么是watch目录每次进行类似lint check的操作。

后来微软推出了lsp协议，编程语言那一侧相当于运行着一个服务器、编辑器那一侧相当于是客户端，从此不用每个编辑器需要为每个支持的语言专门写一次语法检查了

- 原来：编辑器数量*语言数量
- 现在：语言（只做服务端）数量+编辑器（只做客户端）数量

比如以前sublime、atom、vscode、vim都需要支持c、python、go、js，每个编辑器都需要分别对每种语言写一遍语法相关支持，这就是4*4=16，要是再多个语言或编辑器，工作量就得+4。

有了LSP之后，四个编辑器分别支持了一下LSP，四个语言分别写了LSP，就全都支持了，工作量是4*0.5+4*0.5，而且就算以后再有新语言或新编辑器，工作量也之需要+0.5就行

#### rollup

#### flow

#### 函数柯理化






参考：
1. [learnVue][learnVueUrl]
2. [Vue技术内幕][vueDesiginUrl]
3. [如何阅读vue源码][howToReadVueSourceCodeUrl]
4. [vue.js源码学习笔记(尤大推荐)][learnVueBookNodeUrl]

#### 源码架构
为了对源码分析有一个整体的概念，先说说vue源码的整体结构，然后再具体分析每一个部分。。。

阅读源码是一个艰巨的任务，需要投入大量的时间和精力。以下是一些提高源代码阅读效率的方法：

1. 阅读文档：在阅读源码之前，先花一些时间阅读官方文档，了解其功能和目的。这样可以大大减少理解和理解代码的时间。
2. 了解结构和设计模式：在阅读源码之前，了解其结构和设计模式可以大大加快阅读速度。
3. 采用自顶向下的方法：首先阅读整体代码的框架和结构，然后再逐步深入细节。这样可以确保我们先了解代码的高层次结构，然后再深入了解其内部运作方式。
4. 画出流程图或时序图：如果你发现自己在阅读代码时很难理解其内部运作方式，可以尝试画出流程图或时序图。这有助于帮助您更好地理解代码的执行过程。
5. 调试代码：如果你在阅读源码时遇到了问题，可以使用调试器来跟踪代码的执行过程。这有助于您了解代码的执行方式和内部状态。
6. 与社区交流：如果你在阅读源码时遇到了问题，可以向社区寻求帮助。社区的其他成员可能已经遇到过同样的问题，并且可以提供宝贵的见解和建议。

总之，阅读源码需要投入大量时间和精力，需要采用正确的方法。通过结合官方文档、了解结构和设计模式、采用自顶向下的方法、画出流程图、调试代码和与社区交流，您可以更高效地阅读源码。


[vueDesiginUrl]: http://hcysun.me/vue-design/
[learnVueUrl]: https://github.com/answershuto/learnVue
[howToReadVueSourceCodeUrl]: https://www.zhihu.com/question/36986850
[learnVueBookNodeUrl]: http://jiongks.name/blog/vue-code-review/