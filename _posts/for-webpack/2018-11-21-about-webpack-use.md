---
layout: post
title: webpackä½¿ç”¨
date: Tue Nov 20 2018 16:48:56 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
---
#### webpackä¸­æ–‡æ–‡æ¡£
1. [è€ç‰ˆæœ¬][oldWebpackUrl]
2. [v4.15.1ç‰ˆæœ¬][v4.15.1WebpackUrl]
3. [v4.26.0ç‰ˆæœ¬(æœ€æ–°)][v4.26.0WebpackUrl]


#### 1ã€webpackç®¡ç†pageageçš„å¥½å¤„
å¾ˆæ—©ä¹‹å‰ï¼Œæˆ‘ä»¬å¼•ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–çš„æ–¹å¼ï¼Œæ˜¯é€šè¿‡scriptæ ‡ç­¾å¼•å…¥ï¼Œè¿™ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š
1. éœ€è¦ç¡®ä¿ä¾èµ–ä¸‹è½½å®Œæˆä¹‹åæ‰èƒ½ä½¿ç”¨
2. éœ€è¦ç¡®ä¿ä¾èµ–çš„å¼•å…¥é¡ºåº
3. å¼•å…¥çš„ä¾èµ–å¦‚æœæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œæµè§ˆå™¨ä¹Ÿä¼šä¸‹è½½ï¼Œå å¸¦å®½
4. ç¬¬ä¸‰æ–¹ä¾èµ–å‘ç”Ÿå˜åŒ–åï¼Œéœ€è¦é‡æ–°å¼•å…¥æ–°çš„urlåœ°å€

å› æ­¤ï¼Œæˆ‘ä»¬ç”¨webpackæ¥ç®¡ç†è¿™äº›è„šæœ¬ï¼Œä»è€Œè§£å†³ä»¥ä¸Šçš„ç—›ç‚¹
1. åŒ…ç®¡ç†å™¨è´Ÿè´£ä¾èµ–çš„å®‰è£…
2. package.jsonå®šä¹‰é¡¹ç›®éœ€è¦çš„å„ç§æ¨¡å—åŠé¡¹ç›®çš„é…ç½®ä¿¡æ¯

```bash
# binç›®å½•æ˜¯å­˜æ”¾äºŒè¿›åˆ¶æ‰§è¡Œç¨‹åºçš„
# ç›´æ¥åœ¨node_modules/.binç›®å½•æ‰¾webpackè„šæœ¬æ‰§è¡Œ
$ node node_modules/.bin/webpack

# æœ‰çš„åœ¨.binç›®å½•æ²¡æœ‰ï¼Œåˆ™éœ€è¦å»å¯¹åº”ä¾èµ–åŒ…é‡Œæ‰¾
$ node node_modules/webpack/bin/webpack.js

# npx ä¼šè‡ªåŠ¨æŸ¥æ‰¾webpackè¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œè„šæœ¬ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¸‹è½½
$ npx webpack

# è¿˜å¯ä»¥æŒ‡å®šå…·ä½“çš„æ„å»ºé…ç½®å‚æ•°ï¼Œå¦‚ä¸‹
$ npx webpack --config webpack.config.js

# è¿™ç§çš„è¯å°±æ˜¯ç›´æ¥å»package.jsoné‡Œæ‰¾scriptsä¸‹çš„buildå­—æ®µ
$ npm run build
```
**æ³¨æ„ï¼š**
>å¦‚æœ webpack.config.js å­˜åœ¨ï¼Œåˆ™ webpack å‘½ä»¤å°†é»˜è®¤é€‰æ‹©ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ - -config é€‰é¡¹åªæ˜¯å‘ä½ è¡¨æ˜ï¼Œå¯ä»¥ä¼ é€’ä»»ä½•åç§°çš„é…ç½®æ–‡ä»¶ã€‚è¿™å¯¹äºéœ€è¦æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶çš„å¤æ‚é…ç½®æ˜¯éå¸¸æœ‰ç”¨ã€‚


#### 2ã€webpackè¾“å…¥ä¸è¾“å‡º
ä»¥ä¸‹ä¼šåœ¨distç›®å½•ç”Ÿæˆä¸€ä¸ªåä¸º`mainName.js`çš„æ–‡ä»¶ã€‚
```js
const path = require('path')

module.exports = {
  // é»˜è®¤æ˜¯productionï¼Œä»£ç å‹ç¼©ä¸‘åŒ–
  mode: 'development',
  entry: {
    mainName: './src/index.js'
  },
  output: {
    filename: '[name].js',
    path: path.resolve(__dirname, 'dist')
    }
}
```

ä»¥ä¸‹ä¼šåœ¨distç›®å½•ç”Ÿæˆä¸€ä¸ªåä¸º`main.js`çš„æ–‡ä»¶ã€‚
```js
const path = require('path')
module.exports = {
  mode: 'development',
  entry: './src/index.js',
  output: {
    filename: '[name].js',
    path: path.resolve(__dirname, 'dist')
  }
}
```
**ç»¼ä¸Š**ï¼šé»˜è®¤æƒ…å†µä¸‹ä¼šæ„å»ºå‡ºä¸€ä¸ªåä¸ºmainçš„jsæ–‡ä»¶ï¼Œé™¤éè‡ªå®šä¹‰æ–‡ä»¶å(å¦‚ä¸Šçš„mainName)ã€‚ç„¶ååœ¨outputé‡Œé¢[name]å°±æ˜¯å–è‡ªentryå®šä¹‰çš„åå­—ã€‚

ä¸Šé¢çš„ [name] å…¶å®å°±æ˜¯å†…ç½®çš„nameå˜é‡ï¼Œè¿™æ—¶å¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿å‡½æ•°ï¼Œæ¯ä¸ªè¦è¾“å‡ºçš„æ–‡ä»¶ï¼ˆä¹Ÿå«chunkï¼‰éƒ½ä¼šé€šè¿‡è¿™ä¸ªå‡½æ•°å»æ‹¼æ¥å‡ºè¦è¾“å‡ºçš„æ–‡ä»¶åç§°ã€‚

å†…ç½®å˜é‡é™¤äº†ä¸Šé¢çš„nameï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ªï¼š
- id : chunkçš„å”¯ä¸€æ ‡è¯†ï¼Œä»0å¼€å§‹(ä½†æˆ‘è¿™é‡Œæ‰“å°çš„ä¾ç„¶æ˜¯:main)
- name : chunkçš„åç§°
- hash ï¼šcompilationå¯¹è±¡çš„hashå€¼
- chunkhash ï¼šchunkå†…å®¹çš„hashå€¼

å…¶ä¸­hashå’Œchunkhashçš„é•¿åº¦æ˜¯å¯æŒ‡å®šçš„ï¼Œå¦‚[hash:8]ä»£è¡¨8ä½çš„hashå€¼ï¼Œé»˜è®¤æ˜¯20ä½ã€‚

**æ³¨æ„**ï¼šhashä¸chunkhashçš„åŒºåˆ«ï¼Œ[å‚è€ƒ](https://www.cnblogs.com/ihardcoder/p/5623411.html)
1. [hash] `is replaced by the hash of the compilation.`
  - compilationå¯¹è±¡é’ˆå¯¹çš„æ˜¯éšæ—¶å¯å˜çš„é¡¹ç›®æ–‡ä»¶ï¼Œåªè¦æ–‡ä»¶æœ‰å˜åŠ¨ï¼Œå°±ä¼šé‡å»º
  - hashæ˜¯compilationå¯¹è±¡è®¡ç®—æ‰€å¾—ï¼Œå¯ä»¥ç†è§£ä¸ºé¡¹ç›®æ€»ä½“æ–‡ä»¶çš„hashå€¼
  - å› æ­¤å½“è¾“å‡ºå¾ˆå¤šæ–‡ä»¶æ—¶ï¼Œä½ è‚¯å®šä¸æƒ³å› ä¸ºä¸€ä¸ªæ–‡ä»¶çš„æ”¹å˜ï¼ŒæŠŠæ‰€æœ‰å…¶ä»–æ–‡ä»¶çš„æ–‡ä»¶åéƒ½æ”¹å˜äº†ã€‚ã€‚ã€‚
2. [chunkhash] `is replaced by the hash of the chunk.`
  - ä»£è¡¨å…·ä½“æ¨¡å—(chunk)çš„hashå€¼
  - å½“è¾“å‡ºå¤šæ–‡ä»¶ï¼ŒåŒæ—¶æƒ³åˆ©ç”¨ç¼“å­˜ï¼Œ[chunkhash]æ— ç–‘æ˜¯æœ€ä½³é€‰æ‹©

ä½†hashä¸chunkhashä¸€å—ä½¿ç”¨ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š
```js
const path = require('path')
module.exports = {
  // é»˜è®¤æ˜¯productionï¼Œä»£ç å‹ç¼©ä¸‘åŒ–
  mode: 'development',
  entry: './src/index.js',
  output: {
    filename: '[hash][chunkhash].js',
    path: path.resolve(__dirname, 'dist')
  }
}
// é”™è¯¯ä¿¡æ¯
// ERROR in chunk main [entry]
// [hash][chunkhash].js
// Cannot use [chunkhash] or [contenthash] for chunk in '[hash][chunkhash].js' (use [hash] instead)
```

**æ³¨æ„**ï¼šwebpackç¼–è¯‘çš„æ–‡ä»¶å…¥å£æ˜¯jsæ–‡ä»¶ï¼Œä¸æ”¯æŒå…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œ å› æ­¤è¦ç¼–è¯‘styleæ–‡ä»¶ï¼Œéœ€è¦å°†å…¶å¯¼å…¥åˆ°jsæ–‡ä»¶ä¸­ç„¶åå†ç¼–è¯‘ã€‚ä½†è¿™æ ·ä¼šé€ æˆä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯**æ­¤æ—¶æ— è®ºä¿®æ”¹styleæ–‡ä»¶è¿˜æ˜¯jsæ–‡ä»¶ï¼Œéƒ½ä¼šå¯¼è‡´chunkhashæ”¹å˜**ï¼Œå› ä¸ºå°†styleæ ·å¼æ–‡ä»¶æ‰“åŒ…åˆ°jsæ–‡ä»¶é‡Œäº†ï¼Œå› æ­¤æ­¤æ—¶å¯ä»¥é…åˆæ’ä»¶`extract-text-webpack-plugin`æä¾›çš„`contenthash`æ¥è§£å†³ï¼Œè¡¨ç¤ºæ–‡æœ¬å†…å®¹çš„hashå€¼ï¼Œä¹Ÿå°±æ˜¯åªæœ‰styleæ–‡ä»¶hashå€¼ã€‚

#### 3ã€**webpackç®¡ç†èµ„æº**
åœ¨webpackä¹‹å‰ï¼Œæˆ‘ä»¬åˆ©ç”¨gruntå’Œgulpæ¥å¤„ç†èµ„æºï¼Œå¹¶å°†å®ƒä»¬ä» /src æ–‡ä»¶å¤¹ç§»åŠ¨åˆ° /dist æˆ– /build ç›®å½•ä¸­ã€‚åŒæ ·æ–¹å¼ä¹Ÿè¢«ç”¨äº JavaScript æ¨¡å—ï¼Œä½†æ˜¯ï¼Œåƒ webpack è¿™æ ·çš„å·¥å…·ï¼Œå°†åŠ¨æ€æ‰“åŒ…(dynamically bundle)æ‰€æœ‰ä¾èµ–é¡¹ï¼ˆåˆ›å»ºæ‰€è°“çš„ä¾èµ–å›¾(dependency graph)ï¼‰ã€‚è¿™æ˜¯æå¥½çš„åˆ›ä¸¾ï¼Œå› ä¸ºç°åœ¨æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥æ˜ç¡®è¡¨è¿°å®ƒè‡ªèº«çš„ä¾èµ–ï¼Œæˆ‘ä»¬å°†é¿å…æ‰“åŒ…æœªä½¿ç”¨çš„æ¨¡å—ã€‚

è¿˜å¯ä»¥é€šè¿‡loaderæ¥å¼•å…¥ä»»ä½•å…¶ä»–ç±»å‹çš„æ–‡ä»¶

#### 3.1ã€**å¤„ç†cssç­‰æ ·å¼æ–‡ä»¶**
[å‚è€ƒ1](https://github.com/zhengweikeng/blog/issues/9) <br/>
[å‚è€ƒ2](https://blog.csdn.net/u010982507/article/details/81337529)<br/>
[ç°åœ¨æ¨èä½¿ç”¨mini-css-extract-plugin](https://github.com/webpack-contrib/mini-css-extract-plugin)<br/>
[webpackåŠ è½½css,sass,lessç­‰èµ„æºå¹¶é›†æˆpostcss](https://github.com/iSpring/babel-webpack-react-redux-tutorials/blob/master/tutorials/load-css-with-webpack/README.md)

æˆ‘ä»¬è¦çŸ¥é“ï¼Œwebpackä»å…¥å£æ–‡ä»¶å¼€å§‹è§£æï¼Œç„¶åé‡åˆ°å„ç§ç±»å‹çš„èµ„æºä¼šå°è¯•å¯»æ‰¾å¯¹åº”çš„loaderè§„åˆ™ï¼ŒåŒ¹é…ä¸Šäº†å°±ä½¿ç”¨ç›¸åº”çš„loaderå¤„ç†ï¼Œå¤„ç†å®Œå†è¾“å‡ºåˆ°æŒ‡å®šç›®å½•ã€‚ç„¶åæˆ‘ä»¬çš„é¡µé¢å¼•ç”¨çš„æœ€ç»ˆæ–‡ä»¶ä¹Ÿæ˜¯æ‰“åŒ…å®Œæˆçš„ï¼Œå› æ­¤å¦‚æœæŸäº›èµ„æºå¤„ç†çš„ä¸å¯¹ï¼Œé¡µé¢å°±ä¼šå‡ºç°é”™è¯¯ï¼ŒåŒæ—¶æ„å»ºæ—¥å¿—ä¼šæŠ¥é”™ã€‚ã€‚ã€‚

å¤„ç†æ ·å¼æ–‡ä»¶é…ç½®æµç¨‹åº”ä¸ºï¼š
1. å®‰è£…`npm i -D style-loader,css-loader`
2. é…ç½®webpackåŒ¹é…cssè§„åˆ™

```js
module: {
  rules: [
    {
      test: /\.css$/,
      use: ['style-loader','css-loader']
    }
  ]
}
```
3. ç¼–è¾‘cssæ–‡ä»¶ï¼Œå¼•å…¥å¹¶ä½¿ç”¨

å…¶ä¸­[style-loader][styleLoaderUrl]æ’ä»¶ä½œç”¨æ˜¯åœ¨æœ€ç»ˆé¡µé¢æ’å…¥`style`æ ‡ç­¾ï¼ŒåŒæ—¶è‡ªåŠ¨å¼•å…¥å¯¹åº”çš„cssæ–‡ä»¶ã€‚è€Œä¸”è¿˜è¦åœ¨é¡µé¢ä¸­æŸ¥çœ‹ï¼ˆä¸è¦æ£€æŸ¥é¡µé¢æºä»£ç ï¼Œå› ä¸ºå®ƒä¸ä¼šæ˜¾ç¤ºç»“æœï¼‰ï¼ŒæŸ¥çœ‹headæ ‡ç­¾ï¼Œå°±å¯ä»¥çœ‹åˆ°styleæ ‡ç­¾ã€‚

**ç–‘é—®ï¼Ÿ**åœ¨ä¸ä½¿ç”¨åˆ†ç¦»æ’ä»¶æ—¶ï¼Œcssæ–‡ä»¶è¢«æ‰“åŒ…åˆ°äº†main.jsæ–‡ä»¶é‡Œï¼ŒğŸ‘†çš„è¿‡ç¨‹æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ<br/>
**ç­”:**å°†åŸç”Ÿçš„cssæ–‡ä»¶æ‰“åŒ…æˆjsæ–‡ä»¶æ—¶ï¼Œä¼šåœ¨jsæ–‡ä»¶ä¸­ç”Ÿæˆå¾ˆå¤šé¢å¤–çš„å‡½æ•°ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶å°†cssæ³¨å…¥åˆ°styleæ ‡ç­¾é‡Œã€‚è¿™å°±ä¼šé€ æˆæ–‡ä»¶è‡ƒè‚¿ï¼Œå¦‚ä¸€ä¸ª1KBçš„æœªè¢«å‹ç¼©çš„CSSæ–‡ä»¶ç”Ÿæˆçš„å¯¹åº”çš„jsæ–‡ä»¶å¤§çº¦æœ‰16KBï¼Œè¿™å¯¼è‡´äº†è¾“å‡ºæ–‡ä»¶è¿‡äºåºå¤§ï¼Œå½±å“ä¼ è¾“é€Ÿåº¦ã€‚

å…ˆæ¥çœ‹çœ‹å¦‚ä½•åˆ†ç¦»css,è¿™é‡Œç”¨åˆ°æ’ä»¶`extract-text-webpack-plugin`,å› æ­¤å…ˆå®‰è£…ï¼Œç„¶åå¢åŠ é…ç½®å¦‚ä¸‹ï¼š

```js
// æ’ä»¶ä½¿ç”¨ï¼šhttps://webpack.docschina.org/plugins/extract-text-webpack-plugin/
const ExtractTextPlugin = require('extract-text-webpack-plugin')
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        // ExtractTextPlugin.extract(options: loader | object)
        use: ExtractTextPlugin.extract({
          // åº”ç”¨äºæ²¡æœ‰è¢«æå–çš„css
          fallback: 'style-loader',
          use: 'css-loader'
        })
      }
    ]
  },
  // æ³¨å†Œæ’ä»¶
  plugins: [
    // å®ä¾‹åŒ–æ’ä»¶,ExtractTextPlugin(option: filename | object)
    new ExtractTextPlugin('style.css')
  ]
}
```
**æ³¨æ„**åœ¨webpack4ä¸­ï¼Œè‹¥ç›´æ¥`npm i -D extract-text-webpack-plugin`,ç„¶åé…ç½®å¦‚ä¸Šï¼Œæ„å»ºæ—¶ä¼šæŠ¥é”™`Error: Chunk.entrypoints: Use Chunks.groupsIterable and filter by instanceof Entrypoint instead`ã€‚<br/>
**ç­”:**å¯ä»¥å®‰è£…æ—¶æ·»åŠ `@next`è§£å†³(å› ä¸ºå½“å‰ç‰ˆæœ¬ä¸æ”¯æŒwebpack4.0.0ä»¥ä¸Šç‰ˆæœ¬)ã€‚

å¦‚ä¸Šå¤„ç†æ—¶ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š
```
ä¼˜ç‚¹    æ›´å°‘ style æ ‡ç­¾ (æ—§ç‰ˆæœ¬çš„ IE æµè§ˆå™¨æœ‰é™åˆ¶ï¼ŒIE8æœ‰ä¸Šé™)
ç¼ºç‚¹    é¢å¤–çš„ HTTP è¯·æ±‚
ä¼˜ç‚¹    CSS SourceMap (ä½¿ç”¨ devtool: "source-map" å’Œ extract-text-webpack-plugin?sourceMap é…ç½®)
ç¼ºç‚¹    csså­—ç¬¦ä¸²è½¬ä¸ºstyleéœ€è¦æ›´é•¿çš„ç¼–è¯‘æ—¶é—´ï¼Œ
ä¼˜ç‚¹    CSS è¯·æ±‚å¹¶è¡Œ
ç¼ºç‚¹    æ²¡æœ‰è¿è¡Œæ—¶(runtime)çš„å…¬å…±è·¯å¾„ä¿®æ”¹
ä¼˜ç‚¹    CSS å•ç‹¬ç¼“å­˜
ç¼ºç‚¹    æ²¡æœ‰çƒ­æ›¿æ¢
ä¼˜ç‚¹    æ›´å¿«çš„æµè§ˆå™¨è¿è¡Œæ—¶(runtime) (æ›´å°‘ä»£ç å’Œ DOM æ“ä½œ)
ç¼ºç‚¹    ...
```
`extract-text-webpack-plugin`æ’ä»¶è¿˜æœ‰ä¸åŒçš„å‚æ•°é€‰é¡¹ï¼Œ[ç‚¹å‡»æŸ¥çœ‹æ’ä»¶è¯¦æƒ…][extractTextWebpackPluginUrl]
å½“ç„¶æ’ä»¶`extract-text-webpack-plugin`å¯ä»¥åˆ†ç¦»å„ç§è¢«åŒ¹é…çš„èµ„æºï¼Œä½†ç»è¿‡ä¸Šé¢å¤„ç†åï¼Œæ–‡ä»¶æ˜¯è¢«åˆ†ç¦»å‡ºæ¥äº†ï¼Œ**ä½†style-loaderå¤±æ•ˆäº†ï¼Ÿï¼Ÿï¼Ÿ**<br/>
**ç­”:**å•çº¯ä½¿ç”¨åˆ†ç¦»æ’ä»¶ä¼šä½¿å¾—çƒ­æ›´æ–°å¤±æ•ˆï¼Œå› ä¸ºæ¯æ¬¡ç”Ÿæˆçš„æ–‡ä»¶åéƒ½ä¼šå˜(è¿™å¥è¯´è¾å¾…å®Œå–„)ï¼Œå› æ­¤è¦ä¹ˆæ‰‹åŠ¨æ¯æ¬¡å¼•å…¥ï¼Œè¦ä¹ˆå°±æ˜¯å€ŸåŠ©[html-webpack-plugin][htmlWebpackPluginUrl]æ’ä»¶


#### 3.2ã€**å¤„ç†å›¾ç‰‡ç±»æ–‡ä»¶**
é¡µé¢éœ€è¦çš„å›¾ç‰‡ç±»æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨ï¼Œæˆ–ä½¿ç”¨[vueä¸­çš„èµ„æºè·¯å¾„å¤„ç†][vueHandleAssetsPath]ã€‚

å…ˆæ¥çœ‹çœ‹webpackä¸Šå…³äºè§£æå›¾ç‰‡è·¯å¾„çš„åŸç†ï¼š<br/>
å½“ä½¿ç”¨ `import myImg from './xxx/my-img.png`å¼•å…¥å›¾åƒæ—¶ï¼Œwebpackä¼šåˆ©ç”¨[file-loader][fileLoaderUrl]å¤„ç†å›¾ç‰‡å¹¶è¾“å‡ºåˆ°outputç›®å½•ï¼Œå¹¶ä¸”ç”¨`myImg`å˜é‡æŒ‡å‘è¯¥å›¾ç‰‡å¤„ç†åçš„æœ€ç»ˆurlã€‚å½“ä½¿ç”¨ [css-loader][cssLoaderUrl] æ—¶ï¼Œå¦‚ä¸Šæ‰€ç¤ºï¼Œä½ çš„ CSS ä¸­çš„ url('./my-img.png') ä¼šä½¿ç”¨ç±»ä¼¼çš„è¿‡ç¨‹å»å¤„ç†ã€‚loader ä¼šè¯†åˆ«è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œå¹¶å°† './my-image.png' è·¯å¾„ï¼Œæ›¿æ¢ä¸ºè¾“å‡ºç›®å½•ä¸­å›¾åƒçš„æœ€ç»ˆè·¯å¾„ã€‚[html-loader][htmlLoaderUrl] ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç† `<img src="./my-image.png" />`ã€‚

`file-loader`ç”Ÿæˆçš„æ–‡ä»¶åå°±æ˜¯æ–‡ä»¶å†…å®¹çš„md5å“ˆå¸Œå€¼å¹¶ä¼šä¿ç•™æ‰€å¼•ç”¨èµ„æºçš„åŸå§‹æ‰©å±•åã€‚

å†æ¥çœ‹çœ‹vueä¸­è¯´çš„ï¼š
ä¾‹å¦‚ï¼Œ`url(./image.png)` ä¼šè¢«è½¬æ¢ä¸º `require('./image.png')` <br/>
è€Œ`<img src="../image.png">`ä¼šè¢«ç¼–è¯‘ä¸º
```js
createElement('img', { attrs: { src: require('../image.png') }})
```

å¤„ç†å›¾ç‰‡æ­¥éª¤ï¼š
1. å®‰è£…`npm i -D file-loader`
2. é…ç½®webpackåŒ¹é…å›¾ç‰‡è§„åˆ™
```js
module:{
  rules:[
    {
      // è¦ç†Ÿè®°å¸¸ç”¨æ­£åˆ™çš„ç”¨æ³•
      test: /\.(png|svg|jpe?g|gif)$/,
      // useæ˜¯æ•°ç»„ï¼Œå­å…ƒç´ å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯å¯¹è±¡
      use: [
        {
          loader: 'file-loader',
          options: {
            name (file){
              // [name] type: String default: file.basename
              // [path] type: String default: file.dirname
              // è¿™é‡Œçš„[name][path]éƒ½æ˜¯æ’ä»¶æä¾›çš„
              if(env === 'development'){
                return '[path][name].[ext]'
              }
              // hashé»˜è®¤ç®—æ³•æ˜¯md5,å¤„ç†çš„å€¼æ˜¯æ–‡ä»¶å†…å®¹ï¼Œæ„å‘³ç€ä¸æ˜¯æ¯æ¬¡ç¼–è¯‘éƒ½å˜ï¼Œå› ä¸ºå†…å®¹ä¸å˜
              return '[hash].[ext]'
            }
          }
        }
      ]
    }
  ]
}
```
3. ç¼–è¾‘å›¾ç‰‡æ–‡ä»¶ï¼Œå¼•å…¥å¹¶ä½¿ç”¨
```js
// å¯ä»¥ç›´æ¥è¿™æ ·å¼•å…¥å›¾ç‰‡ï¼Œå¹¶ç›´æ¥ä½¿ç”¨
import myImg from './my-img.png'
const newImg = new Image()
newImg.src = myImg
document.appendChild(newImg)
```
**æ³¨æ„**åœ¨ä¸Šè¿°æ“ä½œåï¼Œå›¾ç‰‡è·¯å¾„å°‘ä¸ª`/dist/`ï¼Œå› æ­¤æ‰¾ä¸åˆ°å›¾ç‰‡... <br/>
**ç­”:**index.htmlçš„ä½ç½®åº”è¯¥å’Œdiståœ¨åŒä¸€ä¸ªç›®å½•

ä¸Šé¢è¯´åˆ°[file-loader][fileLoaderUrl]ï¼Œå…¶å®è¿˜æœ‰[url-loader][urlLoaderUrl]ï¼Œè¿™ä¸¤ä¸ªloaderåŠŸèƒ½ç›¸ä¼¼ï¼Œåªæ˜¯åè€…å¯ä»¥è®¾ç½®é˜ˆå€¼ï¼Œå½“å°äºé˜ˆå€¼æ—¶è¿”å›DataURLæ ¼å¼çš„è·¯å¾„ã€‚å…¶å®DataURLæ˜¯æ²¡æœ‰è·¯å¾„å¯è¨€çš„ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä¸ªå›¾ç‰‡èµ„æºã€‚

é…ç½®å¦‚ä¸‹:
```js
module: [
  {
    test: /\.(png|jpe?g|svg|gif)$/,
    use: [
      {
        loader: 'url-loader',
        option: {
          // å°äº10kçš„è½¬æ¢ä¸ºdataURLæ ¼å¼
          limit: 10000,
          // æµè§ˆå™¨é€šå¸¸ä½¿ç”¨MIMEç±»å‹ï¼ˆè€Œä¸æ˜¯æ–‡ä»¶æ‰©å±•åï¼‰æ¥ç¡®å®šå¦‚ä½•å¤„ç†æ–‡æ¡£,ç»ˆç«¯ï¼šfile xxxæŸ¥çœ‹
          // ç”±ç±»å‹ä¸å­ç±»å‹ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­é—´ç”¨'/'åˆ†éš”è€Œç»„æˆ
          // è¿™é‡Œæ˜¯æŒ‡å®šè¦è½¬æ¢æˆçš„dataurlçš„æ–‡ä»¶å­ç±»å‹ï¼Œéœ€è¦ç”¨åˆ°jimpæ’ä»¶(ä¸“é—¨ä¿®æ”¹èµ„æºmimeç±»å‹)
          mimetype: 'image/png',
          // å¤§äºlimitçš„å…ˆç»è¿‡fallbackå¤„ç†ï¼Œè‹¥æ— fallbackåˆ™äº¤ç”±file-loaderå¤„ç†
          fallback: 'responsive-loader'
          //  è¿˜å¯ä»¥è®¾ç½®å¤„ç†çš„è´¨é‡
          quality: 85,
          // å¯ä»¥è®¾ç½®name
          name: '[hash:8].[ext]'
        }
      }
    ]
  }
]
```
ä¸Šé¢æ˜¾å¼çš„ï¼Œåˆ†åˆ«ä½¿ç”¨äº†[file-loader][fileLoaderUrl]æˆ–è€…[url-loader][urlLoaderUrl]ï¼Œå¦‚æœäºŒè€…åŒæ—¶ä½¿ç”¨ï¼Œåˆ™ä¼šæŠŠ[url-loader][urlLoaderUrl]å¤„ç†çš„ç»“æœå†è¾“å‡ºåˆ°distç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ[url-loader][urlLoaderUrl]å¤„ç†ç”Ÿæˆçš„å›¾ç‰‡(æ™®é€šurl)æˆ–dataURLå›¾ç‰‡ï¼Œ[file-loader][fileLoaderUrl]ä¼šå°†è¿™äº›è¯¦ç»†ä¿¡æ¯å†è¾“å‡ºåˆ°distç›®å½•ã€‚

**æ³¨æ„ï¼š**ä¸Šé¢æ“ä½œç”Ÿæ•ˆçš„å‰ææ˜¯ï¼Œåœ¨é…ç½®æ–‡ä»¶é‡Œ[file-loader][fileLoaderUrl]ä¼˜å…ˆé…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å’Œé¡ºåºæœ‰å…³ã€‚

æ¯”å¦‚ï¼š[url-loader][urlLoaderUrl]å¤„ç†ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶åä¸ºï¼š`020f95e5.png`
ç„¶åç»è¿‡[file-loader][fileLoaderUrl]å¤„ç†ä¼šè¾“å‡ºä¸€ä¸ªæ–°æ–‡ä»¶å¦‚ï¼š`1bae1637.png`,å›¾ç‰‡é‡Œçš„å†…å®¹ä¸ºï¼š`module.exports = __webpack_public_path__ + "020f95e5.png";`
æ³¨æ„æ–‡ä»¶å

**æ³¨æ„ï¼š**ç»è¿‡ä¸Šé¢çš„å¤„ç†ï¼Œæ–‡ä»¶å†…å®¹å˜æˆäº†ä»£ç ï¼Œå°±ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡æ ¼å¼ï¼Œä¹Ÿå°±æ‰“ä¸å¼€äº†ã€‚

**ç»¼ä¸Šï¼š**
ä¸Šé¢å¤„ç†äº†cssï¼Œå›¾ç‰‡ç­‰æ–‡ä»¶ç±»å‹ï¼Œå…¶å®è¿˜å¯ä»¥åŠ è½½å­—ä½“ç±»å‹ï¼Œæ•°æ®ç±»å‹(å¦‚ï¼šjsonæ–‡ä»¶ï¼Œcsv,tsvå’Œxmlç­‰)ï¼ŒåŸç†éƒ½æ˜¯ç›¸ä¼¼çš„ã€‚ç±»ä¼¼äº NodeJSï¼ŒJSON æ”¯æŒå®é™…ä¸Šæ˜¯å†…ç½®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ import Data from './data.json' é»˜è®¤å°†æ­£å¸¸è¿è¡Œã€‚è¦å¯¼å…¥ CSVã€TSV å’Œ XMLï¼Œä½ å¯ä»¥ä½¿ç”¨ [csv-loader][csvLoaderUrl] å’Œ [xml-loader][xmlLoaderUrl]ã€‚


#### 4ã€**è‡ªåŠ¨æ›´æ–°å¼•å…¥çš„æ–‡ä»¶**
ä¸Šé¢æˆ‘ä»¬åœ¨index.htmlå†™æ­»äº†å¼•å…¥çš„æ–‡ä»¶åå¦‚`<script src="main.js"></script>`,ä½†å¦‚æœæˆ‘ä»¬æ›´æ”¹äº†å…¥å£åæˆ–å¢åŠ äº†å…¥å£æ•°é‡ï¼Œé‚£å²‚ä¸æ˜¯æ¯æ¬¡éƒ½å¾—æ‰‹åŠ¨æ”¹è¿™ä¸ªindex.htmlã€‚ã€‚ã€‚

é€šè¿‡[html-webpack-plugin][htmlWebpackPluginUrl]è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œè¿™ä¸ªæ’ä»¶çš„ä½œç”¨å°±æ˜¯åœ¨æ¯æ¬¡compilationå‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šé‡æ–°ç”Ÿæˆhtmlæ–‡ä»¶ã€‚

å¼•å…¥æ’ä»¶æ­¥éª¤ï¼š
1. `npm i -D html-webpack-plugin`
2. å¢åŠ `webpack.config.js`é…ç½®å¦‚ä¸‹
```js
const HtmlWebpackPlugin = require('html-webpack-plugin')
module.exports = {
  plugins: [
    new HtmlWebpackPlugin({
      title: 'output Management',
      // é»˜è®¤index.htmlï¼Œè¿˜å¯ä»¥åŠ å­ç›®å½•ï¼šassets/admin.html
      filename: 'my-index.html'
    })
  ]
}
```
ç»è¿‡[html-webpack-plugin][htmlWebpackPluginUrl]æ’ä»¶çš„å¤„ç†ï¼Œä¸ä½†ä¿®å¤äº†ä½¿ç”¨åˆ†ç¦»cssæ’ä»¶å[style-loader][styleLoaderUrl]å¤±æ•ˆçš„é—®é¢˜ï¼Œè¿˜æ¯æ¬¡éƒ½é‡æ–°ç”Ÿæˆindex.htmlã€‚å› æ­¤è¿™æ—¶æŠŠæ•´ä¸ªdistç›®å½•åˆ é™¤äº†ä¹Ÿæ²¡é—®é¢˜äº†ã€‚è€Œä¸”ç”Ÿæˆçš„index.htmlå°±å·²ç»åŒ…å«äº†å„ç§æ ‡ç­¾ã€‚ã€‚ã€‚

**æ³¨æ„**å¦‚æœä½ åœ¨outputé‡Œé…ç½®äº†publicPathï¼Œåˆ™åœ¨ä½¿ç”¨[html-webpack-plugin][htmlWebpackPluginUrl]ç”Ÿæˆçš„htmlæ–‡ä»¶é‡Œç”Ÿæˆçš„å¼•ç”¨æ–‡ä»¶è·¯å¾„å‰ç¼€å°±æ˜¯publicPathäº†


#### 5ã€**å®šåˆ¶è¾“å‡ºæ¨¡æ¿**
åˆ°è¿™é‡Œä½ åº”è¯¥æ€è€ƒï¼Œè¿™ä¸ª`index.html`åº”è¯¥æ˜¯æŸä¸ªæ¨¡æ¿æ–‡ä»¶ç”Ÿæˆï¼Œé‚£æ—¢ç„¶å¦‚æ­¤ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å®šåˆ¶è¿™ä¸ªæ¨¡æ¿å‘¢ï¼Œæ²¡é”™å°±æ˜¯[html-webpack-template][htmlWebpackTemplateUrl],å®‰è£…ç„¶åå¢åŠ é…ç½®å¦‚ä¸‹å³å¯ä½¿ç”¨ï¼š

```js
const HtmlWebpackTemplatePlugin = require('html-webpack-template')
module.exports = {
  plugins: [
    new HtmlWebpackPlugin({
      // required å¿…å¡«é€‰é¡¹
      inject: false,
      template: HtmlWebpackTemplatePlugin
      // template: './src/index.html' //è¿˜å¯ä»¥è‡ªå®šä¹‰æ¨¡æ¿

      // Optional é€‰å¡«é€‰é¡¹
      title: 'output Management',
      filename: 'my-index.html',
      // è¿˜å¯ä»¥å¢åŠ metaç­‰ç­‰æ ‡ç­¾
      meta: [
        {
          name: 'description',
          content: 'A better default template for html-webpack-plugin.'
        }
      ],
    })
  ]
}
```
**æ³¨æ„ï¼š**è¿™æ ·æ„å‘³ç€ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå¯ä»¥çµæ´»åŠ ä»¥åº”ç”¨ã€‚ã€‚ã€‚


#### 6ã€**æ’ä»¶åˆ é™¤distç›®å½•**
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œdistç›®å½•é‡Œçš„æ–‡ä»¶ï¼Œä¸€ç›´éƒ½æ˜¯æ‰‹åŠ¨åˆ é™¤ï¼Œè¿™ä¸ç¬¦åˆç¨‹åºçŒ¿æ‡’çš„ç‰¹è´¨ï¼Œå› æ­¤[clean-webpack-plugin][cleanWebpcakPluginUrl]éœ€è¦äº†è§£ä¸€ä¸‹ï¼š
```js
const CleanWebpackPlugin = require('clean-webpack-plugin')
module.exports = {
  plugins: [
    // new CleanWebpackPlugin(paths [, {options}]) 
    // å‚æ•°ä¸€ï¼špathsæ˜¯æ•°ç»„æˆ–å­—ç¬¦ä¸²ï¼Œæ•°ç»„çš„è¯å¯ä»¥åŒ¹é…å¤šä¸ª
    // å‚æ•°äºŒï¼špathsé…ç½®ç›¸å…³çš„é…ç½®
    new CleanWebpackPlugin(['dist','build/*.*','web/*.js'],{
      // __dirnameè„šæœ¬æ‰§è¡Œçš„ç›®å½•
      root:  __dirname
    })
  ]
}
```

#### 7ã€**webpackç®¡ç†èµ„æºçš„åŸç†**
ä½ å¯èƒ½ä¼šæ„Ÿå…´è¶£ï¼ŒwebpackåŠå…¶æ’ä»¶ä¼¼ä¹â€œçŸ¥é“â€åº”è¯¥å“ªäº›æ–‡ä»¶ç”Ÿæˆï¼Ÿ<br/>
ç­”æ¡ˆæ˜¯ï¼Œé€šè¿‡ manifestï¼Œwebpack èƒ½å¤Ÿå¯¹ã€Œä½ çš„æ¨¡å—æ˜ å°„åˆ°è¾“å‡º bundle çš„è¿‡ç¨‹ã€ä¿æŒè¿½è¸ªã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€çŸ¥é“ï¼ŒwebpackèƒŒåé€šè¿‡ä¸€å®šçš„ç­–ç•¥æ¥æ§åˆ¶æ¨¡å—é—´çš„äº¤äº’ã€‚ã€‚ã€‚ï¼ˆå¾…å®Œå–„ï¼‰


#### 8ã€**å¼€å‘ç¯å¢ƒé…ç½®**
1. scource map
2. webpack's Watch Mode 
3. webpack-dev-server
4. webpack-dev-middleware

ä»¥ä¸Šæˆ‘ä»¬åœ¨ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ä»¥åï¼Œéœ€è¦é‡æ–°æ„å»ºï¼Œç„¶ååˆ·æ–°æµè§ˆå™¨æ‰èƒ½çœ‹åˆ°æ•ˆæœï¼Œè¿™åœ¨å¼€å‘ç¯å¢ƒä¸‹æ— ç–‘æ˜¯ç¹çä¸”ç¬¨æ‹™çš„ï¼Œè¿™é‡Œæˆ‘ä»¬è¯´è¯´å¼€å‘ç¯å¢ƒé…ç½®ã€‚ã€‚ã€‚

**1. [scource map][sourceMapUrl]** <br/>
å½“ä½¿ç”¨webpackæ‰“åŒ…æ–‡ä»¶ä»¥åï¼Œä¸€èˆ¬ä¼šå°†å¾ˆå¤šæ¨¡å—æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œå› æ­¤å½“å…·ä½“æŸä¸ªæ–‡ä»¶é”™è¯¯æ—¶debugå°†å˜å¾—å¼‚å¸¸å›°éš¾ï¼Œåªèƒ½ç²—ç•¥çš„æŒ‡å‘æ‰“åŒ…å‡ºæ¥çš„é‚£ä¸ªå¤§æ–‡ä»¶ï¼Œè€Œæ— æ³•å‡†ç¡®å®šä½åˆ°æºä»£ç çš„å…·ä½“ä½ç½®ï¼Œå› æ­¤`scource map`å°±éœ€è¦äº†è§£ä¸€ä¸‹

source map,å®ƒæ˜¯ä¸€ä¸ªä¿¡æ¯æ–‡ä»¶,é‡Œé¢å­˜å‚¨ç€ä½ç½®ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬æ¢åçš„ä»£ç çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œæ‰€å¯¹åº”çš„è½¬æ¢å‰çš„ä½ç½®ã€‚ä¸è¿‡ç›®å‰å¥½åƒåªæœ‰chromeæµè§ˆå™¨æ”¯æŒï¼ˆåœ¨å¼€å‘è€…å·¥å…·çš„`setting`ä¸­å¼€å¯`Enable source maps`ï¼‰

åœ¨å¼€å¯source mapåï¼Œæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åº•éƒ¨ä¼šæœ‰ç±»ä¼¼`//@ sourceMappingURL=/path/to/file.js.map`è¿™æ ·çš„å†…å®¹ï¼Œæ„æ€æ˜¯è¯´ï¼Œå…·ä½“çš„mapæ–‡ä»¶åœ¨/path/to/file.js.mapè¿™é‡Œã€‚

åªéœ€åœ¨webpack.config.jsæ·»åŠ ä¸‹é¢ä»£ç å³å¯
```js
module.exports = {
  // devtoolæœ‰å¾ˆå¤šé€‰é¡¹,è¿™é‡Œè¯´å‡ é¡¹ï¼Œè¯¦æƒ…å‚è€ƒï¼šhttps://webpack.docschina.org/configuration/devtool

  // æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åº•éƒ¨æœ‰sourceMappingURLå­—æ ·ï¼Œç‚¹å‡»é”™è¯¯å®šä½åˆ°çš„æ˜¯æ²¡ç»å¤„ç†çš„æºç ä½ç½®
  devtool: 'source-map'

  // æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åº•éƒ¨æ²¡æœ‰sourceMappingURLå­—æ ·ï¼Œç‚¹å‡»é”™è¯¯å®šä½åˆ°çš„æ˜¯å‹ç¼©åçš„ä»£ç ä½ç½®
  // æ­¤æ—¶distç›®å½•é‡Œæœ‰mapæ–‡ä»¶
  devtool: 'hidden-source-map'

  // å’Œä¸Šé¢ä¸åŒçš„æ˜¯ï¼Œè¯¥æ¨¡å¼ç”Ÿæˆçš„æ–‡ä»¶ä¸ä½†æœ‰sourceMappingURLå­—æ ·ï¼Œè€Œä¸”æŠŠå…·ä½“çš„mapæ–‡ä»¶å†…å®¹å†…è”åœ¨æ‰“åŒ…çš„æ–‡ä»¶é‡Œäº†ï¼Œè€Œå‰ä¸¤è€…sourceMappingURLçš„å€¼åªæ˜¯ä¸€ä¸ªåœ°å€
  // æ³¨æ„æ­¤æ—¶distç›®å½•æ²¡æœ‰mapæ–‡ä»¶ï¼Œå› ä¸ºç›¸å½“äºå°†mapæ–‡ä»¶å†…æ•›åˆ°chunké‡Œäº†ï¼Œä½†è¿™æ ·ä¼šä½¿å¾—æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å˜å¤§
  devtool: 'inline-source-map'
}
```
>é¿å…åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ inline-*** å’Œ eval-***ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å¢åŠ  bundle å¤§å°ï¼Œå¹¶é™ä½æ•´ä½“æ€§èƒ½ã€‚
æ›´å¤šè¯·å‚è€ƒï¼š<br/>
[æ»´æ»´å‡ºè¡Œè¯´devtoolçš„å‡ ç§æ¨¡å¼][didiDevtoolUrl]<br/>
[é˜®ä¸€å³°-sourceMapè¯¦è§£][ruanyifeng-sourceMapUrl]<br/>


å½“ç„¶æ‰“åŒ…å¤„ç†çš„ä»£ç æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼š
1. å‹ç¼©æ··æ·†
2. å¤šä¸ªæ–‡ä»¶åˆå¹¶ï¼Œå‡å°‘httpè¯·æ±‚
3. å°†å…¶ä»–ç±»å‹æ–‡ä»¶ç¼–è¯‘æˆjsï¼Œå¦‚ts

**2. [webpack's Watch Mode]** <br/>
ç°åœ¨æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦é‡æ–°æ„å»ºï¼Œå¹¶åˆ·æ–°æµè§ˆå™¨æ‰èƒ½çœ‹åˆ°ç»“æœï¼Œè¿™åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¾ˆç¹çï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ·»åŠ watchæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯webapckä¼šè‡ªåŠ¨å¼€å¯watchæ¨¡å¼è§‚å¯Ÿä¾èµ–å›¾ä¸­çš„æ‰€æœ‰çš„æ–‡ä»¶ï¼Œå½“æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±è‡ªåŠ¨é‡æ–°æ„å»ºã€‚ã€‚ã€‚

ä¿®æ”¹package.jsonçš„scriptså¦‚ä¸‹ï¼Œç„¶åè¿è¡Œ`npm run watch`å³å¯ï¼š
```json
{
  "scripts": {
    "watch": "webapck --watch",
    "build": "webpack"
  },
}
```
**æ³¨æ„ç‚¹**è™½ç„¶è‡ªåŠ¨é‡å»ºï¼Œä½†ä»ç„¶éœ€è¦åˆ·æ–°æµè§ˆå™¨æ‰å¯ä»¥çœ‹åˆ°æ•ˆæœ

**3. [webpack-dev-server][webpackDevServerUrl]** <br/>

åœ¨watchæ¨¡å¼ä¸‹ï¼Œè™½ç„¶å¯ä»¥ç›‘å¬æ–‡ä»¶çš„å˜åŠ¨å¹¶è‡ªåŠ¨æ„å»ºï¼Œä½†éœ€è¦åˆ·æ–°æµè§ˆå™¨æ‰å¯ä»¥ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å€ŸåŠ©[webpack-dev-server][webpackDevServerUrl]æ¥å¸®æˆ‘ä»¬è‡ªåŠ¨åˆ·æ–°æµè§ˆã€‚(å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼Œwatchæ¨¡å¼ä¸‹ï¼Œwebpackç›‘è§†çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ)

[webpack-dev-server][webpackDevServerUrl]æä¾›äº†ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œå¹¶èƒ½å¤Ÿè‡ªåŠ¨é‡æ–°åŠ è½½ï¼ŒåŒæ ·éœ€è¦å…ˆå®‰è£…ã€‚

**æ³¨æ„ï¼š**æ­¤æ—¶æ˜¯é‡æ–°åŠ è½½ä¹Ÿå°±æ˜¯liveReloadï¼Œæ˜¯é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚ã€‚ã€‚

```bash
npm i -D webpack-dev-server 
```
ç„¶åé…ç½®webpackæœåŠ¡å™¨ç›‘è§†å“ªä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶å˜åŠ¨ï¼Œå› ä¸ºwatchæ¨¡å¼ä¸‹å·²ç»å°†å˜åŒ–çš„æ–‡ä»¶é‡æ–°æ„å»ºå¹¶è¾“å‡ºåˆ°distç›®å½•äº†ï¼Œå½“ç„¶devServerè‚¯å®šé›†æˆäº†watchã€‚ã€‚ã€‚å¢åŠ é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š
```js
// å’Œentryç­‰åŒç­‰çº§
devServer: {
  // æ¨èç”¨ç»å¯¹è·¯å¾„;å€¼ä¸ºfalseæ—¶è¡¨ç¤ºç¦ç”¨(æ­¤æ—¶éå†çš„ç›®å½•æ˜¯ï¼Ÿ);æ•°ç»„æ—¶è¡¨ç¤ºå¤šä¸ªç›®å½•
  contentBase: path.join(__dirname, "dist"),
  // å½“å¯ç”¨ lazy æ—¶ï¼Œdev-server åªæœ‰åœ¨è¯·æ±‚æ—¶æ‰ç¼–è¯‘åŒ…(bundle)ã€‚è¿™æ„å‘³ç€ webpack ä¸ä¼šç›‘è§†ä»»ä½•æ–‡ä»¶æ”¹åŠ¨ã€‚
  lazy: true
  // ä½¿ç”¨ filenameï¼Œå¯ä»¥åªåœ¨æŸä¸ªæ–‡ä»¶è¢«è¯·æ±‚æ—¶ç¼–è¯‘ã€‚
  filename:'boundle.js',
  // åœ¨æ‰€æœ‰å“åº”ä¸­æ·»åŠ é¦–éƒ¨å†…å®¹ï¼š
  headers: {
  "X-Custom-Foo": "bar"
  }
},
```
å†ä¿®æ”¹package.jsonæ–‡ä»¶å¦‚ä¸‹ï¼š
```json
{
  "scripts": {
    "dev": "webpack-dev-server --open",
    "watch": "webapck --watch",
    "build": "webpack"
  },
}
```
ä¸Šé¢çš„é…ç½®--openæ˜¯è¯´å½“ç¬¬ä¸€æ¬¡æ„å»ºæ—¶ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œå½“åç»­ä¿®æ”¹æ–‡ä»¶äº†ï¼Œä¼šè‡ªåŠ¨æ„å»ºå¹¶é‡æ–°åˆ·æ–°æµè§ˆå™¨ã€‚ã€‚ã€‚<br/>
**æ³¨æ„ï¼š**è¿™é‡Œçš„æ„å»ºåªæ˜¯å‘ç”Ÿåœ¨å†…å­˜ä¸­ï¼Œå¹¶æ²¡æœ‰distç›®å½•ç”Ÿæˆï¼Œè¿™äº›çœ‹ä¸è§çš„å·¥ä½œwebpackåœ¨åå°å¤„ç†(è¯¦æƒ…çœ‹devServeråŸç†)ã€‚

ä½¿ç”¨äº†[webpack-dev-server][webpackDevServerUrl]è™½ç„¶å¯ä»¥è‡ªåŠ¨æ„å»ºå¹¶è‡ªåŠ¨é‡æ–°åŠ è½½ï¼Œä½†æ˜¯**æ•´ä¸ªé¡µé¢çš„é‡æ–°åŠ è½½**ï¼Œæµªè´¹èµ„æºã€‚å› æ­¤éœ€è¦ç”¨åˆ°[æ¨¡å—çƒ­æ›¿æ¢(Hot Module Replacement æˆ– HMR)][hotModuleReplacementUrl]

**[æ¨¡å—çƒ­æ›¿æ¢(Hot Module Replacement æˆ– HMR)][hotModuleReplacementUrl]** <br/>
HMRä¹Ÿå°±æ˜¯åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™æ›¿æ¢ï¼Œæ·»åŠ æˆ–åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚ã€‚ã€‚ç›¸æ¯”LiveReloadè€Œè¨€ï¼Œåªåˆ·æ–°æ”¹å˜çš„éƒ¨åˆ†ã€‚

å¼€å¯HMRçš„ä¸¤ç§æ–¹å¼ï¼š
1. å½“ä½¿ç”¨äº†webapck-dev-serveråï¼Œå¯ä»¥åœ¨é…ç½®äº†`hot:true`ä»¥åï¼Œè¿˜éœ€è¦å®ä¾‹åŒ–`HotModuleReplacementPlugin`æ’ä»¶ï¼Œè¿™æ˜¯webpackå†…ç½®æ’ä»¶
```js
plugins: [
  // ä¸ºäº†æ›´å®¹æ˜“æŸ¥çœ‹è¦ä¿®è¡¥(patch)çš„ä¾èµ–
  new webpack.NamedModulesPlugin(),
  new webpack.HotModuleReplacementPlugin()
]
```
2. é€šè¿‡å‘½ä»¤è¡Œå®ç°ï¼Œå¦‚ä¿®æ”¹è„šæœ¬`webpack-dev-server --open --hot`

å“ªäº›æ–¹å¼åŠ å¿«å¼€å‘é€Ÿåº¦ï¼š
- ä¿ç•™åœ¨å®Œå…¨é‡æ–°åŠ è½½é¡µé¢æ—¶ä¸¢å¤±çš„åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚
- åªæ›´æ–°å˜æ›´å†…å®¹ï¼Œä»¥èŠ‚çœå®è´µçš„å¼€å‘æ—¶é—´ã€‚
- è°ƒæ•´æ ·å¼æ›´åŠ å¿«é€Ÿ - å‡ ä¹ç›¸å½“äºåœ¨æµè§ˆå™¨è°ƒè¯•å™¨ä¸­æ›´æ”¹æ ·å¼ã€‚

**HMRç›‘å¬jsæ–‡ä»¶å˜åŠ¨** <br/>
HMRæ˜¯çƒ­æ¨¡å—æ›¿æ¢ï¼Œå½“ä¸»æ–‡ä»¶å¼•ç”¨äº†å¦ä¸€ä¸ªjsæ–‡ä»¶ï¼Œå½“è¿™ä¸ªjsæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥å°†è¿™ä¸ªå˜åŒ–çš„æ–‡ä»¶ä¼ é€’ç»™[module.hot][moduleHotUrl]è¿™ä¸ªå±æ€§ä¸‹çš„`accept`æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡[HotModuleReplacementPlugin][hotModuleReplacementUrl]æ’ä»¶å¼€å¯äº†HMRä»¥åï¼ŒåŒæ—¶è¿˜æä¾›ä¸€äº›ç›¸å…³æ¥å£ï¼Œè¿™äº›æ¥å£å¯ä»¥æ¥å—ä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œå¹¶è§¦å‘ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¿˜å¯ä»¥è·å–æ¨¡å—çƒ­æ›¿æ¢è¿›ç¨‹çš„çŠ¶æ€ç­‰ä¿¡æ¯ã€‚ã€‚ã€‚å¦‚ä¸‹ï¼š
```js
if(module.hot){
  // å½“æ›´æ–°lazy.jsæ–‡ä»¶åï¼Œä¼šåœ¨æ§åˆ¶å°æ‰“å°module is updated...
  module.hot.accept('./views/lazy',function(){
    console.log('module is updated...');
  })
}
```

**æ³¨æ„ï¼š**ç›‘å¬çš„è¿™ä¸ªjsæ–‡ä»¶ä¸èƒ½ä½œä¸ºå…¥å£ï¼Œå‚è€ƒ[å¯ç”¨HMR](https://www.webpackjs.com/guides/hot-module-replacement/#%E5%90%AF%E7%94%A8-hmr)


**HMRç›‘å¬æ ·å¼æ–‡ä»¶å˜åŠ¨** <br/>
æ­¤å‰è¯´è¿‡style-loaderï¼Œå…¶å®å½“æ›´æ–°cssä¾èµ–æ¨¡å—æ—¶ï¼Œæ­¤loaderåœ¨åå°ä½¿ç”¨[module.hot.accept][moduleHotUrl]æ¥ä¿®è¡¥**(patch)** `<style>`æ ‡ç­¾ã€‚

æ­¤å¤„å‡ºç°äº†patchï¼Œæ„æ€æ˜¯ä¿®è¡¥ï¼Œå¯ä»¥ç†è§£ä¸ºæ›´æ–°çš„æ„æ€ã€‚å¦å¤–å¦‚æœæ­¤æ—¶åƒç›‘å¬jsä¸€æ ·ç›‘å¬css,åˆ™ä¸ä¼šè§¦å‘å¦‚ä¸‹ï¼š
```js
if(module.hot){
  // æ­¤æ—¶æ›´æ–°style.cssï¼Œåˆ™ä¸ä¼šè§¦å‘å›è°ƒã€‚ã€‚ã€‚çŒœæµ‹æ˜¯è¢«style-loaderæ‹¦æˆªäº†
  module.hot.accept('./views/style.css',function(){
    console.log('css module is updated...');
  })
}
```
ç»¼ä¸Šï¼š
>HMR æ˜¯å¯é€‰åŠŸèƒ½ï¼Œåªä¼šå½±å“åŒ…å« HMR ä»£ç çš„æ¨¡å—ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡ style-loader ä¸º style æ ·å¼è¿½åŠ è¡¥ä¸ã€‚ ä¸ºäº†è¿è¡Œè¿½åŠ è¡¥ä¸ï¼Œstyle-loader å®ç°äº† HMR æ¥å£ï¼›å½“å®ƒé€šè¿‡ HMR æ¥æ”¶åˆ°æ›´æ–°ï¼Œå®ƒä¼šä½¿ç”¨æ–°çš„æ ·å¼æ›¿æ¢æ—§çš„æ ·å¼ã€‚

>ç±»ä¼¼çš„ï¼Œå½“åœ¨ä¸€ä¸ªæ¨¡å—ä¸­å®ç°äº† HMR æ¥å£ï¼Œä½ å¯ä»¥æè¿°å‡ºå½“æ¨¡å—è¢«æ›´æ–°åå‘ç”Ÿäº†ä»€ä¹ˆã€‚ç„¶è€Œåœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸éœ€è¦å¼ºåˆ¶åœ¨æ¯ä¸ªæ¨¡å—ä¸­å†™å…¥ HMR ä»£ç ã€‚å¦‚æœä¸€ä¸ªæ¨¡å—æ²¡æœ‰ HMR å¤„ç†å‡½æ•°ï¼Œæ›´æ–°å°±ä¼šå†’æ³¡ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªç®€å•çš„å¤„ç†å‡½æ•°èƒ½å¤Ÿå¯¹æ•´ä¸ªæ¨¡å—æ ‘(complete module tree)è¿›è¡Œæ›´æ–°ã€‚å¦‚æœåœ¨è¿™ä¸ªæ¨¡å—æ ‘ä¸­ï¼Œä¸€ä¸ªå•ç‹¬çš„æ¨¡å—è¢«æ›´æ–°ï¼Œé‚£ä¹ˆæ•´ç»„ä¾èµ–æ¨¡å—éƒ½ä¼šè¢«é‡æ–°åŠ è½½ã€‚

**4. [webpack-dev-middleware][webpackDevMiddlewareUrl]** <br/>
`webpack-dev-middleware` æ˜¯ä¸€ä¸ªå®¹å™¨(wrapper)ï¼Œä»–å¯ä»¥æŠŠwebpackå¤„ç†åçš„æ–‡ä»¶ä¼ é€’ç»™ä¸€ä¸ªæœåŠ¡å™¨(server)ã€‚webpack-dev-serveråœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„åŒ…æ¥ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é…åˆexpressæ¥ä½¿ç”¨å®ƒã€‚

1. `npm i -D express webpack-dev-middleware`
2. å¢åŠ webpack.config.jsé‡Œoutputçš„publicPath

```js
output: {
  filename: '[name].js',
  // è¿™ä¸ªåªæ˜¯æœ¬åœ°ç¡¬ç›˜ä¸Šçš„è·¯å¾„
  path: path.resolve(__dirname, 'dist'),
  // æ‰€æœ‰é€šè¿‡html-webpack-pluginæ’ä»¶æ’å…¥åˆ°é¡µé¢çš„èµ„æºï¼Œå‰ç¼€éƒ½ä¼šæ·»åŠ /spa/,å¦‚æœæ˜¯/spaï¼Œåˆ™æ˜¯/spaxxx
  // ç»å¯¹è·¯å¾„åˆ™ä¼šæ‹¼æ¥ä¸ŠæœåŠ¡åï¼Œå¾ˆå°‘ç”¨ç›¸å¯¹è·¯å¾„
  // å®Œæ•´çš„è·¯å¾„å¦‚https://www.baidu.comï¼Œä¸€èˆ¬æ˜¯å°†èµ„æºæ‰˜ç®¡åˆ°ç¬¬ä¸‰æ–¹å¹³å°
  publicPath: '/spa/'
}
```

3. å¢åŠ æœåŠ¡å™¨æ–‡ä»¶ã€‚

```js
const express = require('express')
const webpack = require('webpack')
const webpackDevMiddleware = require('webpack-dev-middleware')

const app = express()
const config = require('./webpack.config.js')
const compiler = webpack(config)

// å°†webpackDevMiddlewareæ’ä»¶æŒ‚è½½åœ¨expressä¸Šï¼Œç”¨webpack.config.jsçš„é…ç½®è·¯å¾„æ¥é…ç½®æœåŠ¡å™¨çš„åœ°å€
app.use(webpackDevMiddleware(compiler, {
  publicPath: config.output.publicPath
}))

app.listen(3000, function(){
  console.log('server is running : http://localhost:3000')
})
```

4. åœ¨package.jsoné‡Œå¢åŠ 

```json
"scripts": {
  "server": "node server.js"
}
```
5. å¯åŠ¨æœåŠ¡`npm run server`

è¿™æ—¶ä½ ä¼šå‘ç°è®¿é—®`http://localhost:3000`å¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬ç»™æœåŠ¡é…ç½®äº†`publicPath`,å› æ­¤éœ€è¦è®¿é—®`http://localhost:3000/spa/`

**æ€»ç»“**
[webpack-dev-middleware][webpackDevMiddlewareUrl]çš„ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªä¸wabpackçš„compilerç»‘å®šçš„ä¸­é—´ä»¶ï¼Œç„¶ååœ¨expresså¯åŠ¨çš„æœåŠ¡ä¸Šè°ƒç”¨è¿™ä¸ªä¸­é—´ä»¶ã€‚

[webpack-dev-middleware][webpackDevMiddlewareUrl]æ’ä»¶ä½œç”¨ä¸»è¦æœ‰ä¸‰ç‚¹ï¼š
1. é€šè¿‡watch modeï¼Œç›‘å¬èµ„æºçš„å˜æ›´ï¼Œç„¶åè‡ªåŠ¨æ‰“åŒ…
2. å¿«é€Ÿç¼–è¯‘ï¼Œèµ°å†…å­˜
3. è¿”å›ä¸­é—´ä»¶ï¼Œæ”¯æŒexpressçš„useæ ¼å¼

**ç‰¹åˆ«æ³¨æ˜ï¼š**webpackæ˜æ˜å¯ä»¥ç”¨watch modeï¼Œå¯ä»¥å®ç°ä¸€æ ·çš„æ•ˆæœï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿˜éœ€è¦è¿™ä¸ªä¸­é—´ä»¶å‘¢ï¼Ÿ<br/>
**ç­”:**ï¼Œç¬¬äºŒç‚¹æ‰€æåˆ°çš„ï¼Œé‡‡ç”¨äº†å†…å­˜æ–¹å¼ã€‚å¦‚æœï¼Œåªä¾èµ–webpackçš„watch modeæ¥ç›‘å¬æ–‡ä»¶å˜æ›´ï¼Œè‡ªåŠ¨æ‰“åŒ…ï¼Œæ¯æ¬¡å˜æ›´ï¼Œéƒ½å°†æ–°æ–‡ä»¶æ‰“åŒ…åˆ°æœ¬åœ°ï¼Œå°±ä¼šå¾ˆæ…¢ã€‚è€Œ[webpack-dev-middleware][webpackDevMiddlewareUrl]æ’ä»¶æ¯æ¬¡æ„å»ºåŠæ‰“åŒ…éƒ½æ˜¯åœ¨å†…å­˜ä¸­å®Œæˆï¼Œæ„å‘³ç€æ­¤æ—¶ä¸ä¼šç”Ÿæˆdist



#### 9ã€**tree shaking**
éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œé¡¹ç›®é‡Œå¯èƒ½ä¼šå¼•å…¥å¤§é‡ç”¨ä¸åˆ°çš„æ¨¡å—ï¼Œå¦‚æœè¿™äº›æ¨¡å—éƒ½æ‰“åŒ…åˆ°chunké‡Œï¼ŒåŠ¿å¿…é€ æˆå¸¦å®½æµªè´¹ï¼Œå› æ­¤éœ€è¦ä¸€ç§æ‰‹æ®µå°†å…¶æ¸…é™¤ï¼Œä¹Ÿå°±æ˜¯`tree shaking`

æ–°çš„ webpack 4 æ­£å¼ç‰ˆæœ¬ï¼Œæ‰©å±•äº†è¿™ä¸ªæ£€æµ‹èƒ½åŠ›ï¼Œé€šè¿‡ package.json çš„ "sideEffects" å±æ€§ä½œä¸ºæ ‡è®°ï¼Œå‘ compiler æä¾›æç¤ºï¼Œè¡¨æ˜é¡¹ç›®ä¸­çš„å“ªäº›æ–‡ä»¶æ˜¯ "pure(çº¯çš„ ES2015 æ¨¡å—)"ï¼Œç”±æ­¤å¯ä»¥å®‰å…¨åœ°åˆ é™¤æ–‡ä»¶ä¸­æœªä½¿ç”¨çš„éƒ¨åˆ†ã€‚

***9.1ã€tree shakingåŸç†***<br/>
tree shakingæ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œé€šå¸¸ç”¨äºæè¿°ç§»é™¤jsä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç ï¼ˆdead-codeï¼‰ã€‚å®ƒä¾èµ–äºes6æ¨¡å—ç³»ç»Ÿçš„[é™æ€ç»“æ„ç‰¹æ€§][es6StaticDataFeatureUrl],ä¾‹å¦‚ import å’Œ exportã€‚è¿™ä¸ªæœ¯è¯­å’Œæ¦‚å¿µå®é™…ä¸Šæ˜¯å…´èµ·äº ES2015 æ¨¡å—æ‰“åŒ…å·¥å…· rollupã€‚

ä½ å¯ä»¥å°†åº”ç”¨ç¨‹åºæƒ³è±¡æˆä¸€æ£µæ ‘ã€‚ç»¿è‰²è¡¨ç¤ºå®é™…ç”¨åˆ°çš„æºç å’Œ libraryï¼Œæ˜¯æ ‘ä¸Šæ´»çš„æ ‘å¶ã€‚ç°è‰²è¡¨ç¤ºæ— ç”¨çš„ä»£ç ï¼Œæ˜¯ç§‹å¤©æ ‘ä¸Šæ¯èçš„æ ‘å¶ã€‚ä¸ºäº†é™¤å»æ­»å»çš„æ ‘å¶ï¼Œä½ å¿…é¡»æ‘‡åŠ¨è¿™æ£µæ ‘ï¼Œä½¿å®ƒä»¬è½ä¸‹ã€‚

Es6å¼•å…¥è‡ªå·±çš„æ¨¡å—æ ¼å¼çš„ä¸€ä¸ªåŸå› æ˜¯ä¸ºäº†æ”¯æŒé™æ€ç»“æ„ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ã€‚
1. dead code elimination during bundling
- åŠ è½½æ‰“åŒ…åçš„æ–‡ä»¶ï¼Œå¯ä»¥æ£€ç´¢æ›´å°‘çš„æ–‡ä»¶
- å‹ç¼©æ‰“åŒ…åçš„æ–‡ä»¶ï¼Œæ¯”å‹ç¼©å•ç‹¬çš„æ–‡ä»¶æ›´æœ‰æ•ˆ
- bundingè¿‡ç¨‹ä¸­å¯ä»¥åˆ é™¤dead code

2. compact bundling, no custom bundle format
  - å®ƒä»¬çš„é™æ€ç»“æ„æ„å‘³ç€ bundle æ ¼å¼ä¸å¿…è€ƒè™‘æœ‰æ¡ä»¶åŠ è½½çš„æ¨¡å—
  - å¯¼å…¥æ˜¯å¯¼å‡ºçš„åªè¯»è§†å›¾ï¼Œè¿™æ„å‘³ç€æ‚¨ä¸å¿…å¤åˆ¶å¯¼å‡ºï¼Œå¯ä»¥ç›´æ¥å¼•ç”¨å®ƒä»¬

3.  faster lookup of imports (æ›´å¿«çš„æŸ¥æ‰¾å¯¼å…¥)
  - es6æ¨¡å—å¯¼å…¥çš„åº“ï¼Œå¯ä»¥é™æ€çš„çŸ¥é“å¹¶ä¼˜åŒ–

4. variable checking (æ£€æŸ¥å˜é‡)
  - é™æ€æ¨¡å—ç»“æ„ï¼Œæ‚¨æ€»æ˜¯é™æ€åœ°çŸ¥é“å“ªäº›å˜é‡åœ¨æ¨¡å—å†…çš„ä»»ä½•ä½ç½®éƒ½æ˜¯å¯è§çš„
  - å…¨å±€å˜é‡: å”¯ä¸€å®Œå…¨çš„å…¨å±€å˜é‡å°†è¶Šæ¥è¶Šå¤šåœ°æ¥è‡ªè¯­è¨€æœ¬èº«ã€‚ å…¶ä»–çš„ä¸€åˆ‡éƒ½å°†æ¥è‡ªæ¨¡å—(åŒ…æ‹¬æ¥è‡ªæ ‡å‡†åº“å’Œæµè§ˆå™¨çš„åŠŸèƒ½)ã€‚ 
  - å¯¹æ£€æŸ¥ç»™å®šæ ‡è¯†ç¬¦æ˜¯å¦æ‹¼å†™æ­£ç¡®éå¸¸æœ‰å¸®åŠ©(å…¶å®å°±æ˜¯è¯­æ³•æ£€æŸ¥)
5. ready for macros ï¼ˆå¯ä»¥ä½¿ç”¨å®äº†ï¼Œåœ¨ç¼–è¯‘æœŸé—´å¯æ“ä½œè¯­æ³•æ ‘ï¼‰

***9.2ã€tree shakingä½¿ç”¨***<br/>
ä½¿ç”¨æ­¥éª¤ï¼š
1. å®šä¹‰ç±»ä¼¼å¦‚ä¸‹æ–‡ä»¶
```js
// math.js
export function square {
  return x * x
}
export function cube {
  return x * x * x
}
```
2. åœ¨ä¸»æ–‡ä»¶ä¸­å¼•å…¥math.jsä¸­ä¸€ä¸ªå‡½æ•°å¹¶ä½¿ç”¨
```js
import {cube} from './views/math'
console.log(cube(2))
```

3. å¼€å¯ productionæ¨¡å¼è¿™ä¸ªwebpack ç¼–è¯‘æ ‡è®°ï¼Œæ¥è‡ªåŠ¨å¯ç”¨ UglifyJSPlugin å‹ç¼©æ’ä»¶
æŸ¥çœ‹å¤„ç†åçš„ä»£ç å·²ç»åˆ é™¤äº†æœªç”¨çš„åˆ°çš„ä»£ç ï¼Œè€Œä¸”å¤„ç†åçš„ä»£ç ç±»ä¼¼å¦‚ä¸‹ï¼š
```js
"./src/views/math.js":function(n,t,r){"use strict";function e(n){return n*n*n}r.d(t,"a",function(){return e})}});
```

**æ³¨æ„ï¼š**sideEffectsæ ‡ç¤ºå‡ºæ¨¡å—çš„å“ªäº›éƒ¨åˆ†åŒ…å«å¤–éƒ¨ä½œç”¨(side effect)ï¼Œä¹Ÿå°±æ˜¯è¯´æ ‡è¯†å‡ºçš„è¿™éƒ¨åˆ†ä»£ç å³ä½¿æ²¡æœ‰ç”¨åˆ°ï¼Œä¹Ÿä¸èƒ½tree-shakingã€‚ä½†sideEffectsåœ¨webpackçš„rulesé‡ŒåŠpackage.jsoné‡Œé…ç½®éƒ½æ²¡æœ‰æ•ˆæœï¼Ÿï¼Ÿï¼Ÿåœ¨å¼€å‘ç¯å¢ƒä¸‹æ²¡æœ‰å¼€å¯å‹ç¼©ï¼Œå°†å‡½æ•°éƒ½ä¼šæ‰“å‡ºä¸”æ ‡è®°ä¸º`harmony export (binding)`,å¹¶æ²¡æœ‰å®˜æ–¹æŒ‡å—ä¸Šçš„`unused harmony export`ã€‚è€Œç”Ÿäº§ç¯å¢ƒæ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰æ ‡è®°éƒ½ä¼šæ¶ˆå¤±ï¼Œä¸”ä»£ç ä¼šå‹ç¼©æ··æ·†ã€‚

>é€šè¿‡å¦‚ä¸Šæ–¹å¼ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡ import å’Œ export è¯­æ³•ï¼Œæ‰¾å‡ºé‚£äº›éœ€è¦åˆ é™¤çš„â€œæœªä½¿ç”¨ä»£ç (dead code)â€ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬ä¸åªæ˜¯è¦æ‰¾å‡ºï¼Œè¿˜éœ€è¦åœ¨ bundle ä¸­åˆ é™¤å®ƒä»¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ -p(production) è¿™ä¸ª webpack ç¼–è¯‘æ ‡è®°ï¼Œæ¥å¯ç”¨ UglifyJSPlugin æ’ä»¶ã€‚

å†åè¿‡æ¥çœ‹çœ‹ä¸Šé¢å®˜æ–¹çš„ä¸€æ®µè¯ï¼Œä»¥åŠå›é¡¾ä¸€ä¸‹é™æ€æ•°æ®ç»“æ„ï¼Œåˆ™è¡¨æ˜ï¼Œwebpackå¯ä»¥æ ¹æ®importå’Œexportç­‰è¯­æ³•åˆ†æå‡ºå“ªäº›ä»£ç æ˜¯dead-codeï¼Œç„¶åå†åˆ©ç”¨UglifyJSPluginæ’ä»¶åˆ é™¤å¤šä½™ä»£ç ã€‚


#### 10ã€**ç”Ÿäº§ç¯å¢ƒæ„å»º**
å› ä¸ºç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒçš„æ„å»ºç›®æ ‡å·®å¼‚è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦å…·æœ‰å¼ºå¤§çš„ã€å…·æœ‰å®æ—¶é‡æ–°åŠ è½½(live reloading)æˆ–çƒ­æ¨¡å—æ›¿æ¢(hot module replacement)èƒ½åŠ›çš„ source map å’Œ localhost serverã€‚è€Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡åˆ™è½¬å‘äºå…³æ³¨æ›´å°çš„ bundleï¼Œæ›´è½»é‡çš„ source mapï¼Œä»¥åŠæ›´ä¼˜åŒ–çš„èµ„æºï¼Œä»¥æ”¹å–„åŠ è½½æ—¶é—´ã€‚
ç”±äºè¦éµå¾ªé€»è¾‘åˆ†ç¦»ï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®ä¸ºæ¯ä¸ªç¯å¢ƒç¼–å†™å½¼æ­¤ç‹¬ç«‹çš„ webpack é…ç½®ã€‚

è™½ç„¶ï¼Œä»¥ä¸Šæˆ‘ä»¬å°†ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒåšäº†ç•¥å¾®åŒºåˆ†ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šéµå¾ªä¸é‡å¤åŸåˆ™(Don't repeat yourself - DRY)ï¼Œä¿ç•™ä¸€ä¸ªâ€œé€šç”¨â€é…ç½®ã€‚ä¸ºäº†å°†è¿™äº›é…ç½®åˆå¹¶åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º webpack-merge çš„å·¥å…·ã€‚é€šè¿‡â€œé€šç”¨â€é…ç½®ï¼Œæˆ‘ä»¬ä¸å¿…åœ¨ç¯å¢ƒç‰¹å®š(environment-specific)çš„é…ç½®ä¸­é‡å¤ä»£ç ã€‚

1ã€ åˆ†åˆ«å°†webpacké…ç½®åˆ†æˆå¦‚ä¸‹ç»“æ„ï¼Œç„¶åå•ç‹¬æŠ½ç¦»å„ä¸ªç¯å¢ƒä¸‹çš„é…ç½®
```
project-name
  |--src
  |  ...
  |--webpack.base.js
  |--webpack.dev.js
  |--webpack.prod.js
  |--server.js
  |--package.json
  ...
```
2ã€ ä¿®æ”¹package.jsonå¦‚ä¸‹ï¼š
å¯ä»¥çœ‹åˆ°ä¼ å‚å¯ä»¥é€šè¿‡ --config xxxé…ç½®æ–‡ä»¶æ¥å®ç°
```json
{
  "scripts": {
    "dev": "webpack-dev-server --open --config webpack.dev.js",
    "server": "node server.js",
    "watch": "webpack --watch",
    "build": "webpack",
    "dev-build": "webpack --config webpack.dev.js",
    "prod-build": "webpack --config webpack.prod.js",
  },
}
```
3ã€ å¯¹äºå‹ç¼©æ’ä»¶ï¼š
åœ¨`webpack.prod.js`é‡Œï¼Œmodeä¸ºproductionï¼Œä¼šè‡ªåŠ¨å¼€å¯`UglifyJSPlugin`ï¼Œè™½ç„¶å®ƒæ˜¯ä»£ç å‹ç¼©æ–¹é¢æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›å…¶ä»–é€‰æ‹©ï¼š
- BabelMinifyWebpackPlugin
- ClosureCompilerPlugin
**æ³¨æ„ï¼š**å¦‚æœå†³å®šå°è¯•ä¸€äº›å…¶ä»–æ’ä»¶ï¼Œåªè¦ç¡®ä¿æ–°æ’ä»¶ä¹Ÿä¼šæŒ‰ç…§ tree shake ä¸­æ‰€é™ˆè¿°çš„ï¼Œå…·æœ‰åˆ é™¤æœªå¼•ç”¨ä»£ç (dead code)çš„èƒ½åŠ›è¶³çŸ£ã€‚

4ã€ å¯¹äºsource-map
åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨source-mapï¼Œä¾¿äºå¿«é€Ÿç´¢å¼•é”™è¯¯ä½ç½®ã€‚åœ¨å¼€å‘ç¯å¢ƒå› ä¸ºè¿è¡Œåœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥ä½¿ç”¨inline-source-mapã€‚
>é¿å…åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ inline-*** å’Œ eval-***ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å¢åŠ  bundle å¤§å°ï¼Œå¹¶é™ä½æ•´ä½“æ€§èƒ½ã€‚

5ã€ æŒ‡å®šç¯å¢ƒ
è®¸å¤š library å°†é€šè¿‡ä¸ process.env.NODE_ENV ç¯å¢ƒå˜é‡å…³è”ï¼Œä»¥å†³å®š library ä¸­åº”è¯¥å¼•ç”¨å“ªäº›å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå½“ä¸å¤„äºç”Ÿäº§ç¯å¢ƒä¸­æ—¶ï¼ŒæŸäº› library ä¸ºäº†ä½¿è°ƒè¯•å˜å¾—å®¹æ˜“ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ—¥å¿—è®°å½•(log)å’Œæµ‹è¯•(test)ã€‚å…¶å®ï¼Œå½“ä½¿ç”¨ process.env.NODE_ENV === 'production' æ—¶ï¼Œä¸€äº› library å¯èƒ½é’ˆå¯¹å…·ä½“ç”¨æˆ·çš„ç¯å¢ƒè¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œä»è€Œåˆ é™¤æˆ–æ·»åŠ ä¸€äº›é‡è¦ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ webpack å†…ç½®çš„ [DefinePlugin][DefinePluginUrl] ä¸ºæ‰€æœ‰çš„ä¾èµ–å®šä¹‰è¿™ä¸ªå˜é‡ï¼š
```js
  const webpack = require('webpack');
  const merge = require('webpack-merge');
  const UglifyJSPlugin = require('uglifyjs-webpack-plugin');
  const common = require('./webpack.common.js');

  module.exports = merge(common, {
    mode: 'production',
    devtool: 'source-map',
    plugins: [
      new UglifyJSPlugin({
        sourceMap: true
      })
    }),
      new webpack.DefinePlugin({
       'process.env.NODE_ENV': JSON.stringify('production'),
      //  è¿˜å¯è¿™æ ·
			 'process.env': {
				 'NODE_ENV': JSON.stringify('production')
			 },

      //  åœ¨ç”Ÿäº§/å¼€å‘ä¸­ï¼Œæ„å»ºä¸­ä½¿ç”¨ä¸åŒçš„URL
      'SERVICE_URL': JSON.stringify('https://yuccie.github.io/jsArt')
     })
    ]
  });
```
>æŠ€æœ¯ä¸Šè®²ï¼ŒNODE_ENV æ˜¯ä¸€ä¸ªç”± Node.js æš´éœ²ç»™æ‰§è¡Œè„šæœ¬çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚é€šå¸¸ç”¨äºå†³å®šåœ¨å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒ(dev-vs-prod)ä¸‹ï¼ŒæœåŠ¡å™¨å·¥å…·ã€æ„å»ºè„šæœ¬å’Œå®¢æˆ·ç«¯ library çš„è¡Œä¸ºã€‚ç„¶è€Œï¼Œä¸é¢„æœŸä¸åŒçš„æ˜¯ï¼Œæ— æ³•åœ¨æ„å»ºè„šæœ¬ webpack.config.js ä¸­ï¼Œå°† process.env.NODE_ENV è®¾ç½®ä¸º "production"ï¼Œè¯·æŸ¥çœ‹ [#2537][#2537Url]ã€‚å› æ­¤ï¼Œä¾‹å¦‚ process.env.NODE_ENV === 'production' ? '[name].[hash].bundle.js' : '[name].bundle.js' è¿™æ ·çš„æ¡ä»¶è¯­å¥ï¼Œåœ¨ webpack é…ç½®æ–‡ä»¶ä¸­ï¼Œæ— æ³•æŒ‰ç…§é¢„æœŸè¿è¡Œã€‚

[DefinePlugin][DefinePluginUrl]å…è®¸åˆ›å»ºä¸€ä¸ªåœ¨**ç¼–è¯‘æ—¶**å¯ä»¥é…ç½®çš„å…¨å±€å˜é‡ã€‚

ç”¨æ³•ï¼š
- å¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒä¼šè¢«å½“ä½œä¸€ä¸ªä»£ç ç‰‡æ®µæ¥ä½¿ç”¨
- å¦‚æœè¿™ä¸ªå€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä¼šè¢«è½¬åŒ–ä¸ºå­—ç¬¦ä¸²(åŒ…æ‹¬å‡½æ•°)ã€‚
- å¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæ‰€æœ‰çš„ key ä¼šè¢«åŒæ ·çš„æ–¹å¼å®šä¹‰ã€‚
- å¦‚æœåœ¨ä¸€ä¸ª key å‰é¢åŠ äº† typeof,å®ƒä¼šè¢«å®šä¹‰ä¸º typeof è°ƒç”¨ã€‚

**æ³¨æ„ï¼š**
>æ³¨æ„ï¼Œå› ä¸ºè¿™ä¸ªæ’ä»¶ç›´æ¥æ‰§è¡Œæ–‡æœ¬æ›¿æ¢ï¼Œç»™å®šçš„å€¼å¿…é¡»åŒ…å«å­—ç¬¦ä¸²æœ¬èº«å†…çš„å®é™…å¼•å·ã€‚é€šå¸¸ï¼Œæœ‰ä¸¤ç§æ–¹å¼æ¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œä½¿ç”¨ '"production"', æˆ–è€…ä½¿ç”¨ JSON.stringify('production')ã€‚



#### 11ã€**ä»£ç åˆ†ç¦»**
è¯¥ç‰¹æ€§èƒ½å¤ŸæŠŠä»£ç åˆ†ç¦»åˆ°ä¸åŒçš„bundleä¸­ï¼Œç„¶åå¯ä»¥æŒ‰éœ€åŠ è½½æˆ–å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ã€‚ä»£ç åˆ†ç¦»å¯ä»¥ç”¨äºè·å–æ›´å°çš„bundleï¼Œä»¥åŠæ§åˆ¶èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼Œåˆç†ä½¿ç”¨ä¼šæå¤§å½±å“åŠ è½½æ—¶é—´ã€‚

ä¸‰ç§å¸¸ç”¨çš„ä»£ç åˆ†ç¦»æ–¹æ³•ï¼š
- å…¥å£èµ·ç‚¹ï¼šä½¿ç”¨ entry é…ç½®æ‰‹åŠ¨åœ°åˆ†ç¦»ä»£ç ã€‚
- é˜²æ­¢é‡å¤ï¼šä½¿ç”¨ SplitChunks å»é‡å’Œåˆ†ç¦» chunkã€‚
- åŠ¨æ€å¯¼å…¥ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç ã€‚

***å…¥å£èµ·ç‚¹ï¼šä½¿ç”¨ entry é…ç½®æ‰‹åŠ¨åœ°åˆ†ç¦»ä»£ç ***<br/>
å³å°†æ‰‹åŠ¨å¢åŠ å…¥å£æ–‡ä»¶ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š
```js
entry: {
  main:'./src/index.js',
  other:'./src/other.js'
},
```
è¯¥æ–¹æ³•çš„ç¼ºç‚¹ï¼š
- å¦‚æœå…¥å£chunksä¹‹é—´åŒ…å«é‡å¤çš„ä»£ç ï¼Œé‚£æ‰“åŒ…ä¹‹åï¼Œå“ªäº›é‡å¤çš„æ¨¡å—ä¼šè¢«å¼•å…¥åˆ°å„ä¸ªbundleä¸­ã€‚
- ä¸çµæ´»ï¼Œå¹¶ä¸”ä¸èƒ½å°†æ ¸å¿ƒåº”ç”¨ç¨‹åºé€»è¾‘è¿›è¡ŒåŠ¨æ€æ‹†åˆ†ä»£ç ã€‚

***é˜²æ­¢é‡å¤ï¼šä½¿ç”¨ SplitChunks å»é‡å’Œåˆ†ç¦» chunk***<br/>
åœ¨webpack4ä¸­ä½¿ç”¨[SplitChunksPlugin][SplitChunksPluginUrl]æ’ä»¶åˆ†ç¦»ä»£ç ï¼ˆä¹‹å‰çš„[CommonsChunkPlugin][CommonsChunkPluginUrl]å·²è¢«ç§»é™¤ï¼‰.

The SplitChunks æ’ä»¶å¯ä»¥å°†å…¬å…±çš„ä¾èµ–æ¨¡å—æå–åˆ°å·²æœ‰çš„å…¥å£ chunk ä¸­ï¼Œæˆ–è€…æå–åˆ°ä¸€ä¸ªæ–°ç”Ÿæˆçš„ chunkã€‚

åœ¨webapck.base.jså¢åŠ å¦‚ä¸‹é…ç½®
```js
// output:{},
optimization: {
  splitChunks: {
    chunks: 'all'
  }
}
```
å†æ¬¡æ„å»ºï¼Œå³å¯çœ‹åˆ°å·²ç»å°†å…¥å£æ–‡ä»¶ä¸­å¼•ç”¨çš„å…¬å…±æ¨¡å—æŠ½ç¦»å‡ºæ¥äº†ã€‚ã€‚ã€‚**æ³¨æ„ï¼Œè¿™é‡ŒæŠ½ç¦»å‡ºæ¥çš„å…¬å…±æ¨¡å—æ˜¯ç”¨npmåŒ…è£…çš„ï¼Œè€Œä¸æ˜¯è‡ªå·±å†™çš„æ¨¡å—,å› ä¸ºé»˜è®¤åªåˆ†ç¦»node_modulesé‡Œçš„æ–‡ä»¶**ã€‚ã€‚ã€‚ä¸‹é¢æœ‰å…·ä½“é…ç½®

å¦å¤–è¢«æŠ½ç¦»ç”Ÿæˆçš„æ¨¡å—åï¼Œé»˜è®¤å‘½åè§„åˆ™ä¸ºå—çš„æ¥æºå’Œå¼•ç”¨æ–‡ä»¶åï¼ˆä¾‹å¦‚æ­¤å¤„çš„vendors~main~other.jsï¼‰,è¿˜éœ€æ³¨æ„åœ¨å¼€å‘ç¯å¢ƒè‹¥æ„å»ºï¼Œå¼•å…¥çš„åŒ…å³ä½¿æ²¡ç”¨ï¼Œä¹Ÿä¼šæ‰“åŒ…å‡ºæ¥ï¼Œå› ä¸ºtree shakingæ˜¯é…åˆå‹ç¼©ä»£ç æ’ä»¶ä½¿ç”¨çš„ã€‚

å†çœ‹ä¸‹å…¶é»˜è®¤é…ç½®ï¼š
```js
// output:{},
optimization: {
  splitChunks: {
    //é€‰æ‹©å“ªäº›å—è¿›è¡Œä¼˜åŒ–ï¼Œå€¼allï¼Œasync,initial
    // è¿˜å¯ä»¥æ˜¯å‡½æ•°ï¼Œè¿”å›å€¼å°†æŒ‡ç¤ºæ˜¯å¦åŒ…å«æ¯ä¸ªå—
    // åŠŸèƒ½å¼ºå¤§ï¼Œæ„å‘³ç€å³ä½¿åœ¨å¼‚æ­¥ä¸éå¼‚æ­¥ä¹‹é—´ä¹Ÿå¯ä»¥å…±äº«å—
    chunks: 'async',
    // è¦ç”Ÿæˆçš„å—çš„æœ€å°å¤§å°
    minSize: 30000,
    // åˆ†å‰²å‰å¿…é¡»å…±äº«æ¨¡å—çš„æœ€å°å—æ•°(å°±æ˜¯æœ‰å¤šå°‘æ–‡ä»¶å…¬ç”¨å®ƒ)
    minChunks: 1,
    // æŒ‰éœ€åŠ è½½æ—¶çš„æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•°
    maxAsyncRequests: 5,
    // å…¥å£æ–‡ä»¶ä¸­å¹¶è¡Œè¯·æ±‚çš„æœ€å¤§æ•°é‡(åº”è¯¥æ˜¯é’ˆå¯¹å¤šä¸ªå…¥å£æ—¶)
    maxInitialRequests: 3,
    //æŠ½ç¦»å‡ºæ¥çš„åŒ…åå­—åˆ†éš”ç¬¦
    automaticNameDelimiter: '~',
    // ä¸ºtrueåˆ™æ ¹æ®å—åŠç¼“å­˜ç»„å¯†é’¥ç”Ÿæˆåå­—ã€‚è‹¥ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™å°±æ˜¯è‡ªå®šä¹‰å
    name: true,
    // priorityï¼Œä¸€ä¸ªæ¨¡å—å¯ä»¥å±äºå¤šä¸ªç¼“å­˜ç»„ï¼Œè¯¥ä¼˜åŒ–å°†ä¼˜å…ˆé€‰æ‹©å…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„ç¼“å­˜ç»„
    // defaultæ˜¯é»˜è®¤ç»„ï¼Œå…·æœ‰è´Ÿä¼˜å…ˆçº§ï¼Œå…è®¸è‡ªå®šä¹‰ç»„å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§
    cacheGroups: {
      vendors: {
        // ç¼“å­˜ç»„é€‰æ‹©å“ªäº›æ¨¡å—ï¼Œçœç•¥å®ƒ(''ç©ºå­—ç¬¦å³å¯)åˆ™é€‰æ‹©æ‰€æœ‰æ¨¡å—ã€‚
        test: /[\\/]node_modules[\\/]/,
        priority: -10
      },
      default: {
        minChunks: 2,
        priority: -20,
        // boolean,å¦‚æœå½“å‰å—åŒ…å«å·²ç»ä»ä¸»åŒ…ä¸­æ‹†åˆ†å‡ºæ¥çš„æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒå°†é‡ç”¨ï¼Œè€Œä¸æ˜¯æ–°ç”Ÿæˆçš„æ¨¡å—ï¼Œå¯èƒ½ä¼šå½±å“å—çš„ç»“æœæ–‡ä»¶å
        reuseExistingChunk: true
      }
    }
  }
}
```

çŸ¥é“äº†é…ç½®ï¼Œé‚£ä»€ä¹ˆæƒ…å†µä¸‹åˆ†åŒ…å‘¢ï¼Ÿå‡å¦‚æœ‰å¦‚ä¸‹ä»£ç ï¼š
```js
// entry.js

// dynamic imports
import('./a');
import('./b');

// a.js
import './helpers'; // helpers is 40kb in size

// b.js
import './helpers';
import './more-helpers'; // more-helpers is also 40kb in size
```
åˆ†æä¸Šé¢ä»£ç ï¼š
- helpersæ¨¡å—æœ‰ä¸¤å¤„å¯¼å…¥
- helpersæ¨¡å—å¤§å°å¤§äº30kb
- å¯¼å…¥è°ƒç”¨æ—¶çš„å¹¶è¡Œè¯·æ±‚æ•°ä¸º2
- Doesn't affect request at initial page loadï¼ˆé¡µé¢åˆå§‹åŒ–ä¸å½±å“åŠ è½½ï¼‰
å› ä¸ºæ»¡è¶³ä»¥ä¸Šå››ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥`helper`ä¼šè¢«å•ç‹¬æ‰“åŒ…åˆ°ä¸€ä¸ªæ¨¡å—ã€‚
**æ³¨æ„**å…¶å®æµè§ˆå™¨å¯¹å¹¶å‘è¯·æ±‚æ•°é‡ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œå› æ­¤åˆé€‚çš„æ‰“åŒ…å¤„ç†æœ‰åˆ©äºæµè§ˆå™¨åŠ è½½èµ„æºæ–‡ä»¶ï¼Œé€šè¿‡æŠ½ç¦»å…¬å…±æ¨¡å—ï¼Œæœ€ç»ˆåˆæˆçš„æ–‡ä»¶åªåœ¨æœ€å¼€å§‹çš„æ—¶å€™åŠ è½½ä¸€æ¬¡ï¼Œä¾¿å­˜åˆ°ç¼“å­˜ä¸­ä¾›åç»­ä½¿ç”¨ã€‚

å¯å†ç»“åˆ[CommonsChunkPlugin][CommonsChunkPluginUrl]ç†è§£

å‡ºæ¥ä¸Šé¢çš„ä¸¤ç§åˆ†ç¦»ä»£ç æ’ä»¶ï¼Œè¿˜æœ‰ä¸€äº›ç¤¾åŒºæä¾›çš„ï¼Œå¦‚ä¸‹ï¼š
- mini-css-extract-plugin: ç”¨äºå°† CSS ä»ä¸»åº”ç”¨ç¨‹åºä¸­åˆ†ç¦»ã€‚
- bundle-loader: ç”¨äºåˆ†ç¦»ä»£ç å’Œå»¶è¿ŸåŠ è½½ç”Ÿæˆçš„ bundleã€‚
- promise-loader: ç±»ä¼¼äº bundle-loader ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯ promisesã€‚

***åŠ¨æ€å¯¼å…¥ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç ***<br/>
å½“æ¶‰åŠåŠ¨æ€ä»£ç æ‹†åˆ†æ—¶ï¼Œwebpackæä¾›äº†ä¸¤ç§ç±»ä¼¼çš„æŠ€æœ¯:
1. ä½¿ç”¨ç¬¦åˆ ECMAScript ææ¡ˆ çš„ import() è¯­æ³• (æ¨è)
2. ä½¿ç”¨ webpack ç‰¹å®šçš„ require.ensure

>import() è°ƒç”¨ä¼šåœ¨å†…éƒ¨ç”¨åˆ° promisesã€‚å¦‚æœåœ¨æ—§æœ‰ç‰ˆæœ¬æµè§ˆå™¨ä¸­ä½¿ç”¨ import()ï¼Œè®°å¾—ä½¿ç”¨ ä¸€ä¸ª polyfill åº“ï¼ˆä¾‹å¦‚ es6-promise æˆ– promise-polyfillï¼‰ï¼Œæ¥ shim Promiseã€‚






[vueHandleAssetsPath]: https://vue-loader-v14.vuejs.org/zh-cn/configurations/asset-url.html
[extractTextWebpackPluginUrl]: https://webpack.docschina.org/plugins/extract-text-webpack-plugin/
[cssLoaderUrl]: https://github.com/webpack-contrib/css-loader
[styleLoaderUrl]: https://github.com/webpack-contrib/style-loader
[fileLoaderUrl]: https://github.com/webpack-contrib/file-loader
[urlLoaderUrl]: https://github.com/webpack-contrib/url-loader
[htmlLoaderUrl]: https://github.com/webpack-contrib/html-loader
[oldWebpackUrl]: https://zhaoda.net/webpack-handbook/
[v4.15.1WebpackUrl]: https://webpack.css88.com/loaders/node-loader.html
[v4.26.0WebpackUrl]: https://www.webpackjs.com/configuration/target/
[csvLoaderUrl]: https://github.com/theplatapi/csv-loader
[xmlLoaderUrl]: https://github.com/gisikw/xml-loader
[htmlWebpackPluginUrl]: https://github.com/jantimon/html-webpack-plugin
[htmlWebpackTemplateUrl]: https://github.com/jaketrent/html-webpack-template
[cleanWebpcakPluginUrl]: https://www.npmjs.com/package/clean-webpack-plugin
[sourceMapUrl]: https://webpack.docschina.org/configuration/devtool
[didiDevtoolUrl]: https://juejin.im/post/58293502a0bb9f005767ba2f
[ruanyifeng-sourceMapUrl]: http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html
[webpackDevServerUrl]: https://www.webpackjs.com/configuration/dev-server/
[hotModuleReplacementUrl]: https://webpack.docschina.org/guides/hot-module-replacement
[moduleHotUrl]: https://www.webpackjs.com/api/hot-module-replacement/
[webpackDevMiddlewareUrl]: https://www.webpackjs.com/api/hot-module-replacement/
[treeShakingUrl]: https://webpack.docschina.org/guides/tree-shaking/
[es6StaticDataFeatureUrl]: http://exploringjs.com/es6/ch_modules.html#static-module-structure
[#2537Url]: https://github.com/webpack/webpack/issues/2537
[DefinePluginUrl]: https://webpack.docschina.org/plugins/define-plugin
[SplitChunksPluginUrl]: https://webpack.docschina.org/plugins/split-chunks-plugin/
[CommonsChunkPluginUrl]: https://webpack.docschina.org/plugins/commons-chunk-plugin/